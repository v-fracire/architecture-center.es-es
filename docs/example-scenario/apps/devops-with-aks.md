---
title: Canalización de CI/CD para cargas de trabajo basadas en contenedores
description: Escenario probado para la creación de una canalización de DevOps para una aplicación web de Node.js que usa Jenkins, Azure Container Registry, Azure Kubernetes Service, Cosmos DB y Grafana.
author: iainfoulds
ms.date: 07/05/2018
ms.openlocfilehash: dceb4ad3c34ec43a54d802772f5817cacdd3929c
ms.sourcegitcommit: 8b5fc0d0d735793b87677610b747f54301dcb014
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 07/29/2018
ms.locfileid: "39334222"
---
# <a name="cicd-pipeline-for-container-based-workloads"></a><span data-ttu-id="c1e82-103">Canalización de CI/CD para cargas de trabajo basadas en contenedores</span><span class="sxs-lookup"><span data-stu-id="c1e82-103">CI/CD pipeline for container-based workloads</span></span>

<span data-ttu-id="c1e82-104">Este escenario de ejemplo es aplicable a empresas que desean modernizar el desarrollo de aplicaciones mediante el uso de contenedores y flujos de trabajo de DevOps.</span><span class="sxs-lookup"><span data-stu-id="c1e82-104">This example scenario is applicable to businesses that want to modernize application development by using containers and DevOps workflows.</span></span> <span data-ttu-id="c1e82-105">En este escenario, Jenkins genera e implementa una aplicación web de Node.js en Azure Container Registry y Azure Kubernetes Service.</span><span class="sxs-lookup"><span data-stu-id="c1e82-105">In this scenario, a Node.js web app is built and deployed by Jenkins into an Azure Container Registry and Azure Kubernetes Service.</span></span> <span data-ttu-id="c1e82-106">Para agregar una capa de base de datos distribuida globalmente, se usa Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="c1e82-106">For a globally distributed database tier, Azure Cosmos DB is used.</span></span> <span data-ttu-id="c1e82-107">Para supervisar y solucionar problemas de rendimiento de la aplicación, Azure Monitor se integra con una instancia y un panel de Grafana.</span><span class="sxs-lookup"><span data-stu-id="c1e82-107">To monitor and troubleshoot application performance, Azure Monitor integrates with a Grafana instance and dashboard.</span></span>

<span data-ttu-id="c1e82-108">Algunos ejemplos de escenarios de aplicación son la provisión de un entorno de desarrollo automatizado, la validación de nuevas confirmaciones de código y la inserción de nuevas implementaciones en entornos de ensayo o producción.</span><span class="sxs-lookup"><span data-stu-id="c1e82-108">Example application scenarios include providing an automated development environment, validating new code commits, and pushing new deployments into staging or production environments.</span></span> <span data-ttu-id="c1e82-109">Tradicionalmente, las empresas tenían que crear y compilar las aplicaciones y actualizaciones manualmente, y mantener una base de código grande y rígida.</span><span class="sxs-lookup"><span data-stu-id="c1e82-109">Traditionally, businesses had to manually build and compile applications and updates, and maintain a large, monolithic code base.</span></span> <span data-ttu-id="c1e82-110">Un enfoque moderno del desarrollo de aplicaciones que usa integración continua (CI) e implementación continua (CD) permite crear, probar e implementar servicios más rápidamente.</span><span class="sxs-lookup"><span data-stu-id="c1e82-110">With a modern approach to application development that uses continuous integration (CI) and continuous deployment (CD), you can more quickly build, test, and deploy services.</span></span> <span data-ttu-id="c1e82-111">Este enfoque moderno permite lanzar aplicaciones y actualizaciones a los clientes más rápidamente y responder a las cambiantes demandas del negocio de manera más ágil.</span><span class="sxs-lookup"><span data-stu-id="c1e82-111">This modern approach lets you release applications and updates to your customers faster, and respond to changing business demands in a more agile manner.</span></span>

<span data-ttu-id="c1e82-112">Con servicios de Azure como Azure Kubernetes Service, Container Registry y Cosmos DB, las empresas pueden usar las últimas novedades en técnicas y herramientas de desarrollo de aplicaciones para simplificar el proceso de una implementación de alta disponibilidad.</span><span class="sxs-lookup"><span data-stu-id="c1e82-112">By using Azure services such as Azure Kubernetes Service, Container Registry, and Cosmos DB, companies can use the latest in application development techniques and tools to simplify the process of implementing high availability.</span></span>

## <a name="related-use-cases"></a><span data-ttu-id="c1e82-113">Casos de uso relacionados</span><span class="sxs-lookup"><span data-stu-id="c1e82-113">Related use cases</span></span>

<span data-ttu-id="c1e82-114">Tenga en cuenta este escenario para los casos de uso siguientes:</span><span class="sxs-lookup"><span data-stu-id="c1e82-114">Consider this scenario for the following use cases:</span></span>

* <span data-ttu-id="c1e82-115">Modernización de procedimientos de desarrollo de aplicaciones a un modelo de microservicios basado en contenedores.</span><span class="sxs-lookup"><span data-stu-id="c1e82-115">Modernizing application development practices to a microservices, container-based approach.</span></span>
* <span data-ttu-id="c1e82-116">Aceleración del desarrollo de aplicaciones y los ciclos de vida de implementación.</span><span class="sxs-lookup"><span data-stu-id="c1e82-116">Speeding up application development and deployment lifecycles.</span></span>
* <span data-ttu-id="c1e82-117">Automatización de las implementaciones para la validación de entornos de prueba o aceptación.</span><span class="sxs-lookup"><span data-stu-id="c1e82-117">Automating deployments to test or acceptance environments for validation.</span></span>

## <a name="architecture"></a><span data-ttu-id="c1e82-118">Arquitectura</span><span class="sxs-lookup"><span data-stu-id="c1e82-118">Architecture</span></span>

![Introducción a la arquitectura de los componentes de Azure implicados en un escenario de DevOps con Jenkins, Azure Container Registry y Azure Kubernetes Service][architecture]

<span data-ttu-id="c1e82-120">Este escenario incluye una canalización de DevOps para una aplicación web de Node.js y un servidor back-end de base de datos.</span><span class="sxs-lookup"><span data-stu-id="c1e82-120">This scenario covers a DevOps pipeline for a Node.js web application and database backend.</span></span> <span data-ttu-id="c1e82-121">Los datos fluyen por el escenario de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="c1e82-121">The data flows through the scenario as follows:</span></span>

1. <span data-ttu-id="c1e82-122">Un programador hace cambios en el código fuente de la aplicación web de Node.js.</span><span class="sxs-lookup"><span data-stu-id="c1e82-122">A developer makes changes to the Node.js web application source code.</span></span>
2. <span data-ttu-id="c1e82-123">El cambio de código se confirma en un repositorio de control de código fuente, por ejemplo, GitHub.</span><span class="sxs-lookup"><span data-stu-id="c1e82-123">The code change is committed to a source control respository, such as GitHub.</span></span>
3. <span data-ttu-id="c1e82-124">Para iniciar el proceso de integración continua (CI), un webhook de GitHub desencadena una compilación del proyecto de Jenkins.</span><span class="sxs-lookup"><span data-stu-id="c1e82-124">To start the continuous integration (CI) process, a GitHub webhook triggers a Jenkins project build.</span></span>
4. <span data-ttu-id="c1e82-125">El trabajo de compilación de Jenkins usa un agente de compilación dinámica en Azure Kubernetes Service para realizar un proceso de compilación del contenedor.</span><span class="sxs-lookup"><span data-stu-id="c1e82-125">The Jenkins build job uses a dynamic build agent in Azure Kubernetes Service to perform a container build process.</span></span>
5. <span data-ttu-id="c1e82-126">Se crea una imagen de contenedor en el código, en el control de código fuente y, a continuación, se inserta en Azure Container Registry.</span><span class="sxs-lookup"><span data-stu-id="c1e82-126">A container image is created from the code in source control, and is then pushed to an Azure Container Registry.</span></span>
6. <span data-ttu-id="c1e82-127">Mediante la implementación continua (CD), Jenkins implementa esta imagen de contenedor actualizada en el clúster de Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="c1e82-127">Through continuous deployment (CD), Jenkins deploys this updated container image to the Kubernetes cluster.</span></span>
7. <span data-ttu-id="c1e82-128">La aplicación web de Node.js usa Azure Cosmos DB como servidor back-end.</span><span class="sxs-lookup"><span data-stu-id="c1e82-128">The Node.js web application uses Azure Cosmos DB as it's backend.</span></span> <span data-ttu-id="c1e82-129">Cosmos DB y Azure Kubernetes Service notifican las métricas a Azure Monitor.</span><span class="sxs-lookup"><span data-stu-id="c1e82-129">Both Cosmos DB and Azure Kubernetes Service report metrics to Azure Monitor.</span></span>
8. <span data-ttu-id="c1e82-130">Una instancia de Grafana proporciona paneles visuales del rendimiento de la aplicación según los datos de Azure Monitor.</span><span class="sxs-lookup"><span data-stu-id="c1e82-130">A Grafana instance provides visual dashboards of the application performance based on the data from Azure Monitor.</span></span>

### <a name="components"></a><span data-ttu-id="c1e82-131">Componentes</span><span class="sxs-lookup"><span data-stu-id="c1e82-131">Components</span></span>

* <span data-ttu-id="c1e82-132">[Jenkins][jenkins] es un servidor de automatización de código abierto que se integra perfectamente con los servicios de Azure para permitir la integración continua (CI) y la entrega continua (CD).</span><span class="sxs-lookup"><span data-stu-id="c1e82-132">[Jenkins][jenkins] is an open-source automation server that can integrate with Azure services to enable continuous integration (CI) and continuous deployment (CD).</span></span> <span data-ttu-id="c1e82-133">En este escenario, Jenkins orquesta la creación de nuevas imágenes de contenedor en función de las confirmaciones en el control de código fuente, inserta esas imágenes en Azure Container Registry, a continuación, actualiza las instancias de aplicación en Azure Kubernetes Service.</span><span class="sxs-lookup"><span data-stu-id="c1e82-133">In this scenario, Jenkins orchestrates the creation of new container images based on commits to source control, pushes those images to Azure Container Registry, then updates application instances in Azure Kubernetes Service.</span></span>
* <span data-ttu-id="c1e82-134">Las [máquinas virtuales Linux de Azure][azurevm-docs] se utilizan para ejecutar las instancias de Jenkins y Grafana.</span><span class="sxs-lookup"><span data-stu-id="c1e82-134">[Azure Linux Virtual Machines][azurevm-docs] are used to run the Jenkins and Grafana instances.</span></span>
* <span data-ttu-id="c1e82-135">[Azure Container Registry][azureacr-docs] almacena y administra las imágenes de contenedor que usa el clúster de Azure Kubernetes Service.</span><span class="sxs-lookup"><span data-stu-id="c1e82-135">[Azure Container Registry][azureacr-docs] stores and manages container images that are used by the Azure Kubernetes Service cluster.</span></span> <span data-ttu-id="c1e82-136">Las imágenes se almacenan de forma segura y se pueden replicar en otras regiones mediante la plataforma Azure, para acelerar los tiempos de implementación.</span><span class="sxs-lookup"><span data-stu-id="c1e82-136">Images are securely stored, and can replicated to other regions by the Azure platform to speed up deployment times.</span></span>
* <span data-ttu-id="c1e82-137">[Azure Kubernetes Service][azureaks-docs] es una plataforma administrada de Kubernetes que permite implementar y administrar aplicaciones en contenedores sin necesidad de tener conocimientos de orquestación de contenedores.</span><span class="sxs-lookup"><span data-stu-id="c1e82-137">[Azure Kubernetes Service][azureaks-docs] is a managed Kubernetes platform that lets you deploy and manage containerized applications without container orchestration expertise.</span></span> <span data-ttu-id="c1e82-138">Como servicio hospedado de Kubernetes, Azure maneja tareas críticas como la supervisión del estado y el mantenimiento para usted.</span><span class="sxs-lookup"><span data-stu-id="c1e82-138">As a hosted Kubernetes service, Azure handles critical tasks like health monitoring and maintenance for you.</span></span>
* <span data-ttu-id="c1e82-139">[Azure Cosmos DB][azurecosmosdb-docs] es una base de datos multimodelo distribuida globalmente que permite elegir entre distintos modelos de base de datos y coherencia en función de sus necesidades.</span><span class="sxs-lookup"><span data-stu-id="c1e82-139">[Azure Cosmos DB][azurecosmosdb-docs] is a globally distributed, multi-model database that allows you to choose from various database and consistency models to suit your needs.</span></span> <span data-ttu-id="c1e82-140">Con Cosmos DB, sus datos se pueden replicar globalmente y no es necesario implementar ni configurar ningún componente de replicación o administración de clústeres.</span><span class="sxs-lookup"><span data-stu-id="c1e82-140">With Cosmos DB, your data can be globally replicated, and there is no cluster management or replication components to deploy and configure.</span></span>
* <span data-ttu-id="c1e82-141">[Azure Monitor][azuremonitor-docs] le ayuda a realizar un seguimiento del rendimiento, a mantener la seguridad y a identificar las tendencias.</span><span class="sxs-lookup"><span data-stu-id="c1e82-141">[Azure Monitor][azuremonitor-docs] helps you track performance, maintain security, and identify trends.</span></span> <span data-ttu-id="c1e82-142">Las métricas obtenidas por el Monitor se pueden usar en otros recursos y herramientas, como Grafana.</span><span class="sxs-lookup"><span data-stu-id="c1e82-142">Metrics obtained by Monitor can be used by other resources and tools, such as Grafana.</span></span>
* <span data-ttu-id="c1e82-143">[Grafana][grafana] es una solución de código abierto para consultar, visualizar, alertar y comprender las métricas.</span><span class="sxs-lookup"><span data-stu-id="c1e82-143">[Grafana][grafana] is an open-source solution to query, visualize, alert, and understand metrics.</span></span> <span data-ttu-id="c1e82-144">Un complemento de origen de datos de Azure Monitor permite a Grafana crear paneles visuales para supervisar el rendimiento de las aplicaciones que se ejecutan en Azure Kubernetes Service y que usan Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="c1e82-144">A data source plugin for Azure Monitor allows Grafana to create visual dashboards to monitor the performance of your applications running in Azure Kubernetes Service and using Cosmos DB.</span></span>

### <a name="alternatives"></a><span data-ttu-id="c1e82-145">Alternativas</span><span class="sxs-lookup"><span data-stu-id="c1e82-145">Alternatives</span></span>

* <span data-ttu-id="c1e82-146">[Visual Studio Team Services][vsts] y Team Foundation Server ayudan a implementar una canalización de integración continua (CI), prueba e implementación continua (CD) para cualquier aplicación.</span><span class="sxs-lookup"><span data-stu-id="c1e82-146">[Visual Studio Team Services][vsts] and Team Foundation Server help you implement a continuous integration (CI), test, and deployment (CD) pipeline for any app.</span></span>
* <span data-ttu-id="c1e82-147">[Kubernetes][kubernetes] se puede ejecutar directamente en máquinas virtuales de Azure en lugar de en un servicio administrado, si desea más control sobre el clúster.</span><span class="sxs-lookup"><span data-stu-id="c1e82-147">[Kubernetes][kubernetes] can be run directly on Azure VMs instead of via a managed service if you would like more control over the cluster.</span></span>
* <span data-ttu-id="c1e82-148">[Service Fabric][service-fabric] es otro orquestador de contenedores que puede reemplazar a AKS.</span><span class="sxs-lookup"><span data-stu-id="c1e82-148">[Service Fabric][service-fabric] is another alternate container orchestrator that can replace AKS.</span></span>

## <a name="considerations"></a><span data-ttu-id="c1e82-149">Consideraciones</span><span class="sxs-lookup"><span data-stu-id="c1e82-149">Considerations</span></span>

### <a name="availability"></a><span data-ttu-id="c1e82-150">Disponibilidad</span><span class="sxs-lookup"><span data-stu-id="c1e82-150">Availability</span></span>

<span data-ttu-id="c1e82-151">Para supervisar el rendimiento de la aplicación e informar sobre problemas, este escenario combina Azure Monitor con Grafana para disponer de paneles visuales.</span><span class="sxs-lookup"><span data-stu-id="c1e82-151">To monitor your application performance and report on issues, this scenario combines Azure Monitor with Grafana for visual dashboards.</span></span> <span data-ttu-id="c1e82-152">Estas herramientas permiten supervisar y solucionar problemas de rendimiento que pueden requerir actualizaciones de código, que después se pueden implementar con la canalización de CI/CD.</span><span class="sxs-lookup"><span data-stu-id="c1e82-152">These tools let you monitor and troubleshoot performance issues that may require code updates, which can all then be deployed with the CI/CD pipeline.</span></span>

<span data-ttu-id="c1e82-153">Como parte del clúster de Azure Kubernetes Service, un equilibrador de carga distribuye el tráfico de aplicación a uno o varios contenedores (pods) que ejecutan la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c1e82-153">As part of the Azure Kubernetes Service cluster, a load balancer distributes application traffic to one or more containers (pods) that run your application.</span></span> <span data-ttu-id="c1e82-154">Este método de ejecutar aplicaciones en contenedor en Kubernetes proporciona una infraestructura de alta disponibilidad para sus clientes.</span><span class="sxs-lookup"><span data-stu-id="c1e82-154">This approach to running containerized applications in Kubernetes provides a highly-available infrastructure for your customers.</span></span>

<span data-ttu-id="c1e82-155">Para ver otros temas de disponibilidad, consulte la [lista de comprobación de disponibilidad][availability] que encontrará en el centro de arquitectura.</span><span class="sxs-lookup"><span data-stu-id="c1e82-155">For other availability topics, see the [availability checklist][availability] available in the architecure center.</span></span>

### <a name="scalability"></a><span data-ttu-id="c1e82-156">Escalabilidad</span><span class="sxs-lookup"><span data-stu-id="c1e82-156">Scalability</span></span>

<span data-ttu-id="c1e82-157">Azure Kubernetes Service permite escalar el número de nodos del clúster para satisfacer la demanda de sus aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="c1e82-157">Azure Kubernetes Service lets you scale the number of cluster nodes to meet the demands of your applications.</span></span> <span data-ttu-id="c1e82-158">A medida que aumenta la aplicación, puede escalar horizontalmente el número de nodos de Kubernetes que ejecutan el servicio.</span><span class="sxs-lookup"><span data-stu-id="c1e82-158">As your application increases, you can scale out the number of Kubernetes nodes that run your service.</span></span>

<span data-ttu-id="c1e82-159">Los datos de la aplicación se almacenan en Azure Cosmos DB, una base de datos multimodelo distribuida globalmente que puede ajustar su tamaño globalmente.</span><span class="sxs-lookup"><span data-stu-id="c1e82-159">Application data is stored in Azure Cosmos DB, a globally distributed, multi-model database that can scale globally.</span></span> <span data-ttu-id="c1e82-160">Cosmos DB elimina la necesidad de escalar la infraestructura, como había que hacer con los componentes de base de datos tradicionales, y permite replicar su base de datos de Cosmos DB globalmente para satisfacer las demandas de los clientes.</span><span class="sxs-lookup"><span data-stu-id="c1e82-160">Cosmos DB abstracts the need to scale your  infrastructure as with traditional database components, and you can choose to replicate your Cosmos DB globally to meet the demands of your customers.</span></span>

<span data-ttu-id="c1e82-161">Para ver otros temas de escalabilidad, consulte la [lista de comprobación de escalabilidad][scalability] que encontrará en el centro de arquitectura.</span><span class="sxs-lookup"><span data-stu-id="c1e82-161">For other scalability topics, see the [scalability checklist][scalability] available in the architecure center.</span></span>

### <a name="security"></a><span data-ttu-id="c1e82-162">Seguridad</span><span class="sxs-lookup"><span data-stu-id="c1e82-162">Security</span></span>

<span data-ttu-id="c1e82-163">Para minimizar la superficie de ataque, estos escenarios no exponen la instancia de máquina virtual de Jenkins mediante HTTP.</span><span class="sxs-lookup"><span data-stu-id="c1e82-163">To minimize the attack footprint, this scenarios does not expose the Jenkins VM instance over HTTP.</span></span> <span data-ttu-id="c1e82-164">Para cualquier tarea de administración que necesite interactuar con Jenkins, cree una conexión remota segura usando un túnel SSH desde el equipo local.</span><span class="sxs-lookup"><span data-stu-id="c1e82-164">For any management tasks that require you to interact with Jenkins, you create a secure remote connection using an SSH tunnel from your local machine.</span></span> <span data-ttu-id="c1e82-165">La autenticación de clave pública SSH solo se permite para las instancias de máquina virtual de Jenkins y Grafana.</span><span class="sxs-lookup"><span data-stu-id="c1e82-165">Only SSH public key authentication is allowed for the Jenkins and Grafana VM instances.</span></span> <span data-ttu-id="c1e82-166">Los inicios de sesión basados en contraseña están deshabilitados.</span><span class="sxs-lookup"><span data-stu-id="c1e82-166">Password-based logins are disabled.</span></span> <span data-ttu-id="c1e82-167">Para más información, consulte [Ejecución de un servidor de Jenkins en Azure](../../reference-architectures/jenkins/index.md).</span><span class="sxs-lookup"><span data-stu-id="c1e82-167">For more information, see [Run a Jenkins server on Azure](../../reference-architectures/jenkins/index.md).</span></span>

<span data-ttu-id="c1e82-168">Para separar las credenciales y los permisos, este escenario usa a una entidad de servicio dedicada de Azure Active Directory (AD).</span><span class="sxs-lookup"><span data-stu-id="c1e82-168">For separation of credentials and permissions, this scenario uses a dedicated Azure Active Directory (AD) service principal.</span></span> <span data-ttu-id="c1e82-169">Las credenciales de esta entidad de servicio se almacenan como un objeto de credencial segura en Jenkins, por lo que no están directamente expuestas ni son visibles dentro de los scripts o la canalización de compilación.</span><span class="sxs-lookup"><span data-stu-id="c1e82-169">The credentials for this service principal are stored as a secure credential object in Jenkins so that they are not directly exposed and visible within scripts or the build pipeline.</span></span>

<span data-ttu-id="c1e82-170">Para obtener instrucciones generales sobre el diseño de soluciones seguras, consulte la [documentación de seguridad de Azure][security].</span><span class="sxs-lookup"><span data-stu-id="c1e82-170">For general guidance on designing secure solutions, see the [Azure Security Documentation][security].</span></span>

### <a name="resiliency"></a><span data-ttu-id="c1e82-171">Resistencia</span><span class="sxs-lookup"><span data-stu-id="c1e82-171">Resiliency</span></span>

<span data-ttu-id="c1e82-172">Este escenario utiliza Azure Kubernetes Service para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c1e82-172">This scenario uses Azure Kubernetes Service for your application.</span></span> <span data-ttu-id="c1e82-173">En Kubernetes se integran los componentes de resistencia que supervisan y reinician los contenedores (pods) en caso de problemas.</span><span class="sxs-lookup"><span data-stu-id="c1e82-173">Built into Kubernetes are resiliency components that monitor and restart the containers (pods) if there is an issue.</span></span> <span data-ttu-id="c1e82-174">Combinados con la ejecución de varios nodos de Kubernetes, la aplicación puede tolerar que un pod o un nodo no estén disponibles.</span><span class="sxs-lookup"><span data-stu-id="c1e82-174">Combined with running multiple Kubernetes nodes, your application can tolerate a pod or node being unavailable.</span></span>

<span data-ttu-id="c1e82-175">Para obtener instrucciones generales sobre el diseño de soluciones resistentes, consulte [Diseño de aplicaciones resistentes de Azure][resiliency].</span><span class="sxs-lookup"><span data-stu-id="c1e82-175">For general guidance on designing resilient solutions, see [Designing resilient applications for Azure][resiliency].</span></span>

## <a name="deploy-the-scenario"></a><span data-ttu-id="c1e82-176">Implementación del escenario</span><span class="sxs-lookup"><span data-stu-id="c1e82-176">Deploy the scenario</span></span>

<span data-ttu-id="c1e82-177">**Requisitos previos**</span><span class="sxs-lookup"><span data-stu-id="c1e82-177">**Prerequisites.**</span></span>

* <span data-ttu-id="c1e82-178">Debe tener una cuenta de Azure.</span><span class="sxs-lookup"><span data-stu-id="c1e82-178">You must have an existing Azure account.</span></span> <span data-ttu-id="c1e82-179">Si no tiene una suscripción a Azure, cree una [cuenta gratuita](https://azure.microsoft.com/free/?WT.mc_id=A261C142F) antes de empezar.</span><span class="sxs-lookup"><span data-stu-id="c1e82-179">If you don't have an Azure subscription, create a [free account](https://azure.microsoft.com/free/?WT.mc_id=A261C142F) before you begin.</span></span>
* <span data-ttu-id="c1e82-180">Necesita un par de claves públicas SSH.</span><span class="sxs-lookup"><span data-stu-id="c1e82-180">You need an SSH public key pair.</span></span> <span data-ttu-id="c1e82-181">Para ver cómo crear un par de claves públicas, consulte [Creación y uso de un par de claves SSH para máquinas virtuales Linux][sshkeydocs].</span><span class="sxs-lookup"><span data-stu-id="c1e82-181">For steps on how to create a public key pair, see [Create and use an SSH key pair for Linux VMs][sshkeydocs].</span></span>
* <span data-ttu-id="c1e82-182">Necesita a una entidad de servicio de Azure Active Directory (AD) para la autenticación del servicio y los recursos.</span><span class="sxs-lookup"><span data-stu-id="c1e82-182">You need an Azure Active Directory (AD) service principal for the authentication of service and resources.</span></span> <span data-ttu-id="c1e82-183">Si es necesario, cree una entidad de servicio con [az ad sp create-for-rbac][createsp].</span><span class="sxs-lookup"><span data-stu-id="c1e82-183">If needed, you can create a service principal with [az ad sp create-for-rbac][createsp]</span></span>

    ```azurecli-interactive
    az ad sp create-for-rbac --name myDevOpsScenario
    ```

    <span data-ttu-id="c1e82-184">Anote los valores de *appId* y *password* que se muestran en la salida de este comando.</span><span class="sxs-lookup"><span data-stu-id="c1e82-184">Make a note of the *appId* and *password* in the output from this command.</span></span> <span data-ttu-id="c1e82-185">Estos valores se proporcionan en la plantilla al implementar el escenario.</span><span class="sxs-lookup"><span data-stu-id="c1e82-185">You provide these values to the template when you deploy the scenario.</span></span>

<span data-ttu-id="c1e82-186">Para implementar este escenario con una plantilla de Azure Resource Manager, realice los pasos siguientes.</span><span class="sxs-lookup"><span data-stu-id="c1e82-186">To deploy this scenario with an Azure Resource Manager template, perform the following steps.</span></span>

1. <span data-ttu-id="c1e82-187">Haga clic en botón **Implementar en Azure**.</span><span class="sxs-lookup"><span data-stu-id="c1e82-187">Click the **Deploy to Azure** button:</span></span><br><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fmspnp%2Fsolution-architectures%2Fmaster%2Fapps%2Fdevops-with-aks%2Fazuredeploy.json" target="_blank"><img src="https://azuredeploy.net/deploybutton.png"/></a>
2. <span data-ttu-id="c1e82-188">Espere a que la implementación de plantilla se abra en Azure Portal y complete los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="c1e82-188">Wait for the template deployment to open in the Azure portal, then complete the following steps:</span></span>
   * <span data-ttu-id="c1e82-189">Elija **Crear nuevo** para el grupo de recursos y proporcione un nombre, por ejemplo, *myAKSDevOpsScenario*.</span><span class="sxs-lookup"><span data-stu-id="c1e82-189">Choose to **Create new** resource group, then provide a name such as *myAKSDevOpsScenario* in the text box.</span></span>
   * <span data-ttu-id="c1e82-190">Seleccione una región en el cuadro de lista desplegable **Ubicación**.</span><span class="sxs-lookup"><span data-stu-id="c1e82-190">Select a region from the **Location** drop-down box.</span></span>
   * <span data-ttu-id="c1e82-191">Escriba el identificador de aplicación de la entidad de servicio y la contraseña del comando `az ad sp create-for-rbac`.</span><span class="sxs-lookup"><span data-stu-id="c1e82-191">Enter your service principal app ID and password from the `az ad sp create-for-rbac` command.</span></span>
   * <span data-ttu-id="c1e82-192">Indique un nombre de usuario y una contraseña segura para la instancia de Jenkins y la consola de Grafana.</span><span class="sxs-lookup"><span data-stu-id="c1e82-192">Provide a username and secure password for the Jenkins instance and Grafana console.</span></span>
   * <span data-ttu-id="c1e82-193">Proporcione una clave SSH para proteger los inicios de sesión en las máquinas virtuales Linux.</span><span class="sxs-lookup"><span data-stu-id="c1e82-193">Provide an SSH key to secure logins to the Linux VMs.</span></span>
   * <span data-ttu-id="c1e82-194">Revise los términos y condiciones, y seleccione **Acepto los términos y condiciones indicados anteriormente**.</span><span class="sxs-lookup"><span data-stu-id="c1e82-194">Review the terms and conditions, then check **I agree to the terms and conditions stated above**.</span></span>
   * <span data-ttu-id="c1e82-195">Seleccione el botón **Comprar**.</span><span class="sxs-lookup"><span data-stu-id="c1e82-195">Select the **Purchase** button.</span></span>

<span data-ttu-id="c1e82-196">La implementación puede tardar unos 15-20 minutos en completarse.</span><span class="sxs-lookup"><span data-stu-id="c1e82-196">It can take 15-20 minutes for the deployment to complete.</span></span>

## <a name="pricing"></a><span data-ttu-id="c1e82-197">Precios</span><span class="sxs-lookup"><span data-stu-id="c1e82-197">Pricing</span></span>

<span data-ttu-id="c1e82-198">Para explorar el costo de ejecutar este escenario, todos los servicios están preconfigurados en la calculadora de costos.</span><span class="sxs-lookup"><span data-stu-id="c1e82-198">To explore the cost of running this scenario, all of the services are pre-configured in the cost calculator.</span></span> <span data-ttu-id="c1e82-199">Para ver cómo cambiarían los precios en su caso concreto, cambie las variables pertinentes para que coincidan con el tráfico esperado.</span><span class="sxs-lookup"><span data-stu-id="c1e82-199">To see how the pricing would change for your particular use case, change the appropriate variables to match your expected traffic.</span></span>

<span data-ttu-id="c1e82-200">Hemos incluido tres perfiles de costos de ejemplo basados en número de imágenes de contenedor que se almacenarán y los nodos de Kubernetes para ejecutar las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="c1e82-200">We have provided three sample cost profiles based on the number of container images to store and Kubernetes nodes to run your applications.</span></span>

* <span data-ttu-id="c1e82-201">[Pequeño][small-pricing]: se corresponde con 1000 compilaciones de contenedor al mes.</span><span class="sxs-lookup"><span data-stu-id="c1e82-201">[Small][small-pricing]: this correlates to 1000 container builds per month.</span></span>
* <span data-ttu-id="c1e82-202">[Mediano][medium-pricing]: se corresponde con 100 000 compilaciones de contenedor al mes.</span><span class="sxs-lookup"><span data-stu-id="c1e82-202">[Medium][medium-pricing]: this correlates to 100,000 container builds per month.</span></span>
* <span data-ttu-id="c1e82-203">[Grande][large-pricing]: se corresponde con 1 000 000 compilaciones de contenedor al mes.</span><span class="sxs-lookup"><span data-stu-id="c1e82-203">[Large][large-pricing]: this correlates to 1,000,000 container builds per month.</span></span>

## <a name="related-resources"></a><span data-ttu-id="c1e82-204">Recursos relacionados</span><span class="sxs-lookup"><span data-stu-id="c1e82-204">Related Resources</span></span>

<span data-ttu-id="c1e82-205">Este escenario utiliza Azure Container Registry y Azure Kubernetes Service para almacenar y ejecutar las aplicaciones basadas en contenedores.</span><span class="sxs-lookup"><span data-stu-id="c1e82-205">This scenario used Azure Container Registry and Azure Kubernetes Service to store and run your container-based applications.</span></span> <span data-ttu-id="c1e82-206">También se puede usar Azure Container Instances para ejecutar aplicaciones basadas en contenedores, sin tener que aprovisionar componentes de orquestación.</span><span class="sxs-lookup"><span data-stu-id="c1e82-206">Azure Container Instances can also be used to run container-based applications, without having to provision any orchestration components.</span></span> <span data-ttu-id="c1e82-207">Para más información, consulte [Introducción a Azure Container Instances][azureaci-docs].</span><span class="sxs-lookup"><span data-stu-id="c1e82-207">For more information, see [Azure Container Instances overview][azureaci-docs].</span></span>

<!-- links -->
[architecture]: ./media/devops-with-aks/architecture-devops-with-aks.png
[autoscaling]: ../../best-practices/auto-scaling.md
[availability]: ../../checklist/availability.md
[azureaci-docs]: /azure/container-instances/container-instances-overview
[azureacr-docs]: /azure/container-registry/container-registry-intro
[azurecosmosdb-docs]: /azure/cosmos-db/introduction
[azureaks-docs]: /azure/aks/intro-kubernetes
[azuremonitor-docs]: /azure/monitoring-and-diagnostics/monitoring-overview
[azurevm-docs]: /azure/virtual-machines/linux/overview
[createsp]: /cli/azure/ad/sp#az-ad-sp-create
[grafana]: https://grafana.com/
[jenkins]: https://jenkins.io/
[resiliency]: ../../resiliency/index.md
[resource-groups]: /azure/azure-resource-manager/resource-group-overview
[security]: /azure/security/
[scalability]: ../../checklist/scalability.md
[sshkeydocs]: /azure/virtual-machines/linux/mac-create-ssh-keys
[vsts]: /vsts/?view=vsts
[kubernetes]: https://kubernetes.io/
[service-fabric]: /azure/service-fabric/

[small-pricing]: https://azure.com/e/841f0a75b1ea4802ba1ac8f7918a71e7
[medium-pricing]: https://azure.com/e/eea0e6d79b4e45618a96d33383ec77ba
[large-pricing]: https://azure.com/e/3faab662c54c473da55a1e93a27e0e64
