---
title: Estilo de arquitectura basada en eventos
description: Describe las ventajas, las dificultades y los procedimientos recomendados para las arquitecturas IoT y basadas en eventos en Azure.
author: MikeWasson
ms.date: 08/30/2018
ms.openlocfilehash: 67e823d72f1f66669a052f7ae05c13adc7e5c463
ms.sourcegitcommit: ae8a1de6f4af7a89a66a8339879843d945201f85
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 08/31/2018
ms.locfileid: "43326115"
---
# <a name="event-driven-architecture-style"></a><span data-ttu-id="733ba-103">Estilo de arquitectura basada en eventos</span><span class="sxs-lookup"><span data-stu-id="733ba-103">Event-driven architecture style</span></span>

<span data-ttu-id="733ba-104">Una arquitectura basada en eventos consta de **productores de eventos** que generan un flujo de eventos, y **consumidores de eventos** que escuchan los eventos.</span><span class="sxs-lookup"><span data-stu-id="733ba-104">An event-driven architecture consists of **event producers** that generate a stream of events, and **event consumers** that listen for the events.</span></span> 

![](./images/event-driven.svg)

<span data-ttu-id="733ba-105">Los eventos se entregan casi en tiempo real, de modo que los consumidores pueden responder inmediatamente a los eventos cuando se producen.</span><span class="sxs-lookup"><span data-stu-id="733ba-105">Events are delivered in near real time, so consumers can respond immediately to events as they occur.</span></span> <span data-ttu-id="733ba-106">Los productores se desconectan de los consumidores &mdash; un productor no sabe que los consumidores están escuchando.</span><span class="sxs-lookup"><span data-stu-id="733ba-106">Producers are decoupled from consumers &mdash; a producer doesn't know which consumers are listening.</span></span> <span data-ttu-id="733ba-107">Los consumidores también se desconectan entre sí, y cada consumidor ve todos los eventos.</span><span class="sxs-lookup"><span data-stu-id="733ba-107">Consumers are also decoupled from each other, and every consumer sees all of the events.</span></span> <span data-ttu-id="733ba-108">Esto difiere de un patrón [Competing Consumers][competing-consumers], donde los consumidores extraen los mensajes de una cola y los mensajes solo se procesan una vez (suponiendo que no haya errores).</span><span class="sxs-lookup"><span data-stu-id="733ba-108">This differs from a [Competing Consumers][competing-consumers] pattern, where consumers pull messages from a queue and a message is processed just once (assuming no errors).</span></span> <span data-ttu-id="733ba-109">En algunos sistemas, como IoT, los eventos se deben ingerir en volúmenes muy altos.</span><span class="sxs-lookup"><span data-stu-id="733ba-109">In some systems, such as IoT, events must be ingested at very high volumes.</span></span>

<span data-ttu-id="733ba-110">Una arquitectura basada en eventos puede usar un modelo pub/sub o un modelo de flujo de eventos.</span><span class="sxs-lookup"><span data-stu-id="733ba-110">An event driven architecture can use a pub/sub model or an event stream model.</span></span> 

- <span data-ttu-id="733ba-111">**Pub/sub**: la infraestructura de mensajería mantiene un seguimiento de las suscripciones.</span><span class="sxs-lookup"><span data-stu-id="733ba-111">**Pub/sub**: The messaging infrastructure keeps track of subscriptions.</span></span> <span data-ttu-id="733ba-112">Cuando se publica un evento, se envía el evento a cada suscriptor.</span><span class="sxs-lookup"><span data-stu-id="733ba-112">When an event is published, it sends the event to each subscriber.</span></span> <span data-ttu-id="733ba-113">Después de que se recibe un evento, no se puede reproducir, y los nuevos suscriptores no ven el evento.</span><span class="sxs-lookup"><span data-stu-id="733ba-113">After an event is received, it cannot be replayed, and new subscribers do not see the event.</span></span> 

- <span data-ttu-id="733ba-114">**Flujo de eventos**: los eventos se escriben en un registro.</span><span class="sxs-lookup"><span data-stu-id="733ba-114">**Event streaming**: Events are written to a log.</span></span> <span data-ttu-id="733ba-115">Los eventos siguen un orden estricto (dentro de una partición) y son duraderos.</span><span class="sxs-lookup"><span data-stu-id="733ba-115">Events are strictly ordered (within a partition) and durable.</span></span> <span data-ttu-id="733ba-116">Los clientes no se suscriben al flujo, sino que un cliente puede leer desde cualquiera de sus partes.</span><span class="sxs-lookup"><span data-stu-id="733ba-116">Clients don't subscribe to the stream, instead a client can read from any part of the stream.</span></span> <span data-ttu-id="733ba-117">El cliente es responsable de avanzar su posición en el flujo.</span><span class="sxs-lookup"><span data-stu-id="733ba-117">The client is responsible for advancing its position in the stream.</span></span> <span data-ttu-id="733ba-118">Esto significa que un cliente puede unirse en cualquier momento y puede reproducir los eventos.</span><span class="sxs-lookup"><span data-stu-id="733ba-118">That means a client can join at any time, and can replay events.</span></span>

<span data-ttu-id="733ba-119">En el lado del consumidor, hay algunas variaciones comunes:</span><span class="sxs-lookup"><span data-stu-id="733ba-119">On the consumer side, there are some common variations:</span></span>

- <span data-ttu-id="733ba-120">**Procesamiento sencillo de eventos**.</span><span class="sxs-lookup"><span data-stu-id="733ba-120">**Simple event processing**.</span></span> <span data-ttu-id="733ba-121">Un evento desencadena inmediatamente una acción en el consumidor.</span><span class="sxs-lookup"><span data-stu-id="733ba-121">An event immediately triggers an action in the consumer.</span></span> <span data-ttu-id="733ba-122">Por ejemplo, podría usar Azure Functions con un desencadenador de Service Bus para que una función se ejecute cada vez que se publica un mensaje en un tema de Service Bus.</span><span class="sxs-lookup"><span data-stu-id="733ba-122">For example, you could use Azure Functions with a Service Bus trigger, so that a function executes whenever a message is published to a Service Bus topic.</span></span>

- <span data-ttu-id="733ba-123">**Procesamiento de eventos complejos**.</span><span class="sxs-lookup"><span data-stu-id="733ba-123">**Complex event processing**.</span></span> <span data-ttu-id="733ba-124">Un consumidor procesa una serie de eventos, en busca de patrones en los datos de eventos, mediante una tecnología como Azure Stream Analytics o Apache Storm.</span><span class="sxs-lookup"><span data-stu-id="733ba-124">A consumer processes a series of events, looking for patterns in the event data, using a technology such as Azure Stream Analytics or Apache Storm.</span></span> <span data-ttu-id="733ba-125">Por ejemplo, podría agregar las lecturas de un dispositivo insertado durante una ventana de tiempo y generar una notificación si la media móvil supera un umbral determinado.</span><span class="sxs-lookup"><span data-stu-id="733ba-125">For example, you could aggregate readings from an embedded device over a time window, and generate a notification if the moving average crosses a certain threshold.</span></span> 

- <span data-ttu-id="733ba-126">**Procesamiento de flujo de eventos**.</span><span class="sxs-lookup"><span data-stu-id="733ba-126">**Event stream processing**.</span></span> <span data-ttu-id="733ba-127">Use una plataforma de flujo de datos, como Azure IoT Hub o Apache Kafka, como canalización para ingerir eventos y suministrarlos a procesadores de flujo.</span><span class="sxs-lookup"><span data-stu-id="733ba-127">Use a data streaming platform, such as Azure IoT Hub or Apache Kafka, as a pipeline to ingest events and feed them to stream processors.</span></span> <span data-ttu-id="733ba-128">Los procesadores de flujos sirven para procesar o transformar el flujo.</span><span class="sxs-lookup"><span data-stu-id="733ba-128">The stream processors act to process or transform the stream.</span></span> <span data-ttu-id="733ba-129">Puede haber varios procesadores de flujo para diferentes subsistemas de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="733ba-129">There may be multiple stream processors for different subsystems of the application.</span></span> <span data-ttu-id="733ba-130">Este enfoque es una buena opción para las cargas de trabajo de IoT.</span><span class="sxs-lookup"><span data-stu-id="733ba-130">This approach is a good fit for IoT workloads.</span></span>

<span data-ttu-id="733ba-131">El origen de los eventos puede ser externo con respecto al sistema, como dispositivos físicos en una solución de IoT.</span><span class="sxs-lookup"><span data-stu-id="733ba-131">The source of the events may be external to the system, such as physical devices in an IoT solution.</span></span> <span data-ttu-id="733ba-132">En ese caso, el sistema debe ser capaz de ingerir los datos según el volumen y el rendimiento que requiere el origen de datos.</span><span class="sxs-lookup"><span data-stu-id="733ba-132">In that case, the system must be able to ingest the data at the volume and throughput that is required by the data source.</span></span>

<span data-ttu-id="733ba-133">En el diagrama lógico anterior, se muestra cada tipo de consumidor como un solo cuadro.</span><span class="sxs-lookup"><span data-stu-id="733ba-133">In the logical diagram above, each type of consumer is shown as a single box.</span></span> <span data-ttu-id="733ba-134">En la práctica, es habitual tener varias instancias de un consumidor para evitar hacer que el consumidor se convierta en un único punto de error en el sistema.</span><span class="sxs-lookup"><span data-stu-id="733ba-134">In practice, it's common to have multiple instances of a consumer, to avoid having the consumer become a single point of failure in system.</span></span> <span data-ttu-id="733ba-135">También podrían ser necesarias varias instancias para administrar el volumen y la frecuencia de los eventos.</span><span class="sxs-lookup"><span data-stu-id="733ba-135">Multiple instances might also be necessary to handle the volume and frequency of events.</span></span> <span data-ttu-id="733ba-136">Además, un único consumidor podría procesar eventos en varios subprocesos.</span><span class="sxs-lookup"><span data-stu-id="733ba-136">Also, a single consumer might process events on multiple threads.</span></span> <span data-ttu-id="733ba-137">Esto puede crear dificultades si los eventos se deben procesar en orden o requieren la semántica exactly-once.</span><span class="sxs-lookup"><span data-stu-id="733ba-137">This can create challenges if events must be processed in order, or require exactly-once semantics.</span></span> <span data-ttu-id="733ba-138">Consulte [Minimizar la coordinación][minimize-coordination].</span><span class="sxs-lookup"><span data-stu-id="733ba-138">See [Minimize Coordination][minimize-coordination].</span></span> 

## <a name="when-to-use-this-architecture"></a><span data-ttu-id="733ba-139">Cuándo utilizar esta arquitectura</span><span class="sxs-lookup"><span data-stu-id="733ba-139">When to use this architecture</span></span>

- <span data-ttu-id="733ba-140">Varios subsistemas deben procesar los mismos eventos.</span><span class="sxs-lookup"><span data-stu-id="733ba-140">Multiple subsystems must process the same events.</span></span> 
- <span data-ttu-id="733ba-141">Procesamiento en tiempo real con retardo mínimo.</span><span class="sxs-lookup"><span data-stu-id="733ba-141">Real-time processing with minimum time lag.</span></span>
- <span data-ttu-id="733ba-142">Procesamiento de eventos complejos, como coincidencia de patrones o agregación durante ventanas de tiempo.</span><span class="sxs-lookup"><span data-stu-id="733ba-142">Complex event processing, such as pattern matching or aggregation over time windows.</span></span>
- <span data-ttu-id="733ba-143">Gran volumen y alta velocidad de datos, como IoT.</span><span class="sxs-lookup"><span data-stu-id="733ba-143">High volume and high velocity of data, such as IoT.</span></span>

## <a name="benefits"></a><span data-ttu-id="733ba-144">Ventajas</span><span class="sxs-lookup"><span data-stu-id="733ba-144">Benefits</span></span>

- <span data-ttu-id="733ba-145">Se desvinculan productores y consumidores.</span><span class="sxs-lookup"><span data-stu-id="733ba-145">Producers and consumers are decoupled.</span></span>
- <span data-ttu-id="733ba-146">Ninguna integración punto a punto.</span><span class="sxs-lookup"><span data-stu-id="733ba-146">No point-to point-integrations.</span></span> <span data-ttu-id="733ba-147">Es fácil agregar nuevos consumidores al sistema.</span><span class="sxs-lookup"><span data-stu-id="733ba-147">It's easy to add new consumers to the system.</span></span>
- <span data-ttu-id="733ba-148">Los consumidores pueden responder a eventos inmediatamente a medida que llegan.</span><span class="sxs-lookup"><span data-stu-id="733ba-148">Consumers can respond to events immediately as they arrive.</span></span> 
- <span data-ttu-id="733ba-149">Muy escalable y distribuida.</span><span class="sxs-lookup"><span data-stu-id="733ba-149">Highly scalable and distributed.</span></span> 
- <span data-ttu-id="733ba-150">Los subsistemas tienen vistas independientes del flujo de eventos.</span><span class="sxs-lookup"><span data-stu-id="733ba-150">Subsystems have independent views of the event stream.</span></span>

## <a name="challenges"></a><span data-ttu-id="733ba-151">Desafíos</span><span class="sxs-lookup"><span data-stu-id="733ba-151">Challenges</span></span>

- <span data-ttu-id="733ba-152">Entrega garantizada.</span><span class="sxs-lookup"><span data-stu-id="733ba-152">Guaranteed delivery.</span></span> <span data-ttu-id="733ba-153">En algunos sistemas, especialmente en escenarios de IoT, es fundamental garantizar la entrega de los eventos.</span><span class="sxs-lookup"><span data-stu-id="733ba-153">In some systems, especially in IoT scenarios, it's crucial to guarantee that events are delivered.</span></span>
- <span data-ttu-id="733ba-154">Procesamiento de eventos en orden o exactamente una vez.</span><span class="sxs-lookup"><span data-stu-id="733ba-154">Processing events in order or exactly once.</span></span> <span data-ttu-id="733ba-155">Cada tipo de consumidor normalmente se ejecuta en varias instancias, a fin de conseguir resistencia y escalabilidad.</span><span class="sxs-lookup"><span data-stu-id="733ba-155">Each consumer type typically runs in multiple instances, for resiliency and scalability.</span></span> <span data-ttu-id="733ba-156">Esto puede suponer un desafío si se deben procesar los eventos en orden (dentro de un tipo de consumidor), o si la lógica de procesamiento no es idempotente.</span><span class="sxs-lookup"><span data-stu-id="733ba-156">This can create a challenge if the events must be processed in order (within a consumer type), or if the processing logic is not idempotent.</span></span>

 <!-- links -->

[competing-consumers]: ../../patterns/competing-consumers.md
[minimize-coordination]: ../design-principles/minimize-coordination.md


