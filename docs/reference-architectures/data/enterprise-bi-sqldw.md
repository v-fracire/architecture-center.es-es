---
title: Inteligencia empresarial con SQL Data Warehouse
description: Use Azure para obtener perspectivas empresariales de datos relacionales almacenados localmente
author: MikeWasson
ms.date: 07/01/2018
ms.openlocfilehash: e3542e40b4b6d1f604f93bb21528f34ba7f22fc6
ms.sourcegitcommit: 58d93e7ac9a6d44d5668a187a6827d7cd4f5a34d
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 07/02/2018
ms.locfileid: "37142342"
---
# <a name="enterprise-bi-with-sql-data-warehouse"></a><span data-ttu-id="8971c-103">Inteligencia empresarial con SQL Data Warehouse</span><span class="sxs-lookup"><span data-stu-id="8971c-103">Enterprise BI with SQL Data Warehouse</span></span>

<span data-ttu-id="8971c-104">Esta arquitectura de referencia implementa una canalización [ELT](../../data-guide/relational-data/etl.md#extract-load-and-transform-elt) (extracción, carga y transformación) que mueve los datos desde una base de datos de SQL Server local a SQL Data Warehouse y transforma los datos para el análisis.</span><span class="sxs-lookup"><span data-stu-id="8971c-104">This reference architecture implements an [ELT](../../data-guide/relational-data/etl.md#extract-load-and-transform-elt) (extract-load-transform) pipeline that moves data from an on-premises SQL Server database into SQL Data Warehouse and transforms the data for analysis.</span></span> [<span data-ttu-id="8971c-105">**Implemente esta solución**.</span><span class="sxs-lookup"><span data-stu-id="8971c-105">**Deploy this solution**.</span></span>](#deploy-the-solution)

![](./images/enterprise-bi-sqldw.png)

<span data-ttu-id="8971c-106">**Escenario**: una organización tiene un gran conjunto de datos OLTP almacenado en una base de datos de SQL Server de forma local.</span><span class="sxs-lookup"><span data-stu-id="8971c-106">**Scenario**: An organization has a large OLTP data set stored in a SQL Server database on premises.</span></span> <span data-ttu-id="8971c-107">La organización desea utilizar SQL Data Warehouse para realizar análisis con Power BI.</span><span class="sxs-lookup"><span data-stu-id="8971c-107">The organization wants to use SQL Data Warehouse to perform analysis using Power BI.</span></span> 

<span data-ttu-id="8971c-108">Esta arquitectura de referencia está diseñada para trabajos únicos o a petición.</span><span class="sxs-lookup"><span data-stu-id="8971c-108">This reference architecture is designed for one-time or on-demand jobs.</span></span> <span data-ttu-id="8971c-109">Si tiene que mover los datos de forma continua (cada hora o diariamente), se recomienda utilizar Azure Data Factory de Azure para definir un flujo de trabajo automatizado.</span><span class="sxs-lookup"><span data-stu-id="8971c-109">If you need to move data on a continuing basis (hourly or daily), we recommend using Azure Data Factory to define an automated workflow.</span></span> <span data-ttu-id="8971c-110">Para ver una arquitectura de referencia que use Data Factory, consulte [Inteligencia empresarial automatizada con SQL Data Warehouse y Azure Data Factory](./enterprise-bi-adf.md).</span><span class="sxs-lookup"><span data-stu-id="8971c-110">For a reference architecture that uses Data Factory, see [Automated enterprise BI with SQL Data Warehouse and Azure Data Factory](./enterprise-bi-adf.md).</span></span>

## <a name="architecture"></a><span data-ttu-id="8971c-111">Architecture</span><span class="sxs-lookup"><span data-stu-id="8971c-111">Architecture</span></span>

<span data-ttu-id="8971c-112">La arquitectura consta de los siguientes componentes:</span><span class="sxs-lookup"><span data-stu-id="8971c-112">The architecture consists of the following components.</span></span>

### <a name="data-source"></a><span data-ttu-id="8971c-113">Origen de datos</span><span class="sxs-lookup"><span data-stu-id="8971c-113">Data source</span></span>

<span data-ttu-id="8971c-114">**SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="8971c-114">**SQL Server**.</span></span> <span data-ttu-id="8971c-115">Los datos de origen se encuentran en una base de datos de SQL Server de forma local.</span><span class="sxs-lookup"><span data-stu-id="8971c-115">The source data is located in a SQL Server database on premises.</span></span> <span data-ttu-id="8971c-116">Para simular el entorno local, los scripts de implementación de esta arquitectura aprovisionan una máquina virtual en Azure con SQL Server instalado.</span><span class="sxs-lookup"><span data-stu-id="8971c-116">To simulate the on-premises environment, the deployment scripts for this architecture provision a VM in Azure with SQL Server installed.</span></span> <span data-ttu-id="8971c-117">La [base de datos OLTP de ejemplo de OLTP Wide World Importers][wwi] se usa como datos de origen.</span><span class="sxs-lookup"><span data-stu-id="8971c-117">The [Wide World Importers OLTP sample database][wwi] is used as the source data.</span></span>

### <a name="ingestion-and-data-storage"></a><span data-ttu-id="8971c-118">Ingesta y almacenamiento de datos</span><span class="sxs-lookup"><span data-stu-id="8971c-118">Ingestion and data storage</span></span>

<span data-ttu-id="8971c-119">**Blob Storage**.</span><span class="sxs-lookup"><span data-stu-id="8971c-119">**Blob Storage**.</span></span> <span data-ttu-id="8971c-120">Blob Storage se utiliza como un área de ensayo para copiar los datos antes de cargarlos en SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="8971c-120">Blob storage is used as a staging area to copy the data before loading it into SQL Data Warehouse.</span></span>

<span data-ttu-id="8971c-121">**Azure SQL Data Warehouse**.</span><span class="sxs-lookup"><span data-stu-id="8971c-121">**Azure SQL Data Warehouse**.</span></span> <span data-ttu-id="8971c-122">[SQL Data Warehouse](/azure/sql-data-warehouse/) es un sistema distribuido diseñado para realizar análisis con datos de gran tamaño.</span><span class="sxs-lookup"><span data-stu-id="8971c-122">[SQL Data Warehouse](/azure/sql-data-warehouse/) is a distributed system designed to perform analytics on large data.</span></span> <span data-ttu-id="8971c-123">Admite el procesamiento paralelo masivo (MPP), lo que lo hace idóneo para ejecutar análisis de alto rendimiento.</span><span class="sxs-lookup"><span data-stu-id="8971c-123">It supports massive parallel processing (MPP), which makes it suitable for running high-performance analytics.</span></span> 

### <a name="analysis-and-reporting"></a><span data-ttu-id="8971c-124">Análisis e informes</span><span class="sxs-lookup"><span data-stu-id="8971c-124">Analysis and reporting</span></span>

<span data-ttu-id="8971c-125">**Azure Analysis Services**.</span><span class="sxs-lookup"><span data-stu-id="8971c-125">**Azure Analysis Services**.</span></span> <span data-ttu-id="8971c-126">[Analysis Services](/azure/analysis-services/) es un servicio completamente administrado que proporciona funcionalidades de modelado de datos.</span><span class="sxs-lookup"><span data-stu-id="8971c-126">[Analysis Services](/azure/analysis-services/) is a fully managed service that provides data modeling capabilities.</span></span> <span data-ttu-id="8971c-127">Use Analysis Services para crear un modelo semántico que los usuarios puedan consultar.</span><span class="sxs-lookup"><span data-stu-id="8971c-127">Use Analysis Services to create a semantic model that users can query.</span></span> <span data-ttu-id="8971c-128">Analysis Services es especialmente útil en un escenario de panel de BI.</span><span class="sxs-lookup"><span data-stu-id="8971c-128">Analysis Services is especially useful in a BI dashboard scenario.</span></span> <span data-ttu-id="8971c-129">En esta arquitectura, Analysis Services lee los datos del almacenamiento de datos para procesar el modelo semántico, y atiende a las consultas del panel.</span><span class="sxs-lookup"><span data-stu-id="8971c-129">In this architecture, Analysis Services reads data from the data warehouse to process the semantic model, and efficiently serves dashboard queries.</span></span> <span data-ttu-id="8971c-130">También admite simultaneidad elástica mediante el escalado horizontal de réplicas para agilizar el procesamiento de consultas.</span><span class="sxs-lookup"><span data-stu-id="8971c-130">It also supports elastic concurrency, by scaling out replicas for faster query processing.</span></span>

<span data-ttu-id="8971c-131">Actualmente, Azure Analysis Services admite los modelos tabulares pero no los multidimensionales.</span><span class="sxs-lookup"><span data-stu-id="8971c-131">Currently, Azure Analysis Services supports tabular models but not multidimensional models.</span></span> <span data-ttu-id="8971c-132">Los modelos tabulares utilizan construcciones de modelado relacional (tablas y columnas), mientras que los modelos multidimensionales usan construcciones de modelado OLAP (cubos, dimensiones y medidas).</span><span class="sxs-lookup"><span data-stu-id="8971c-132">Tabular models use relational modeling constructs (tables and columns), whereas multidimensional models use OLAP modeling constructs (cubes, dimensions, and measures).</span></span> <span data-ttu-id="8971c-133">Si necesita modelos multidimensionales, utilice SQL Server Analysis Services (SSAS).</span><span class="sxs-lookup"><span data-stu-id="8971c-133">If you require multidimensional models, use SQL Server Analysis Services (SSAS).</span></span> <span data-ttu-id="8971c-134">Para más información, consulte [Comparar soluciones tabulares y multidimensionales](/sql/analysis-services/comparing-tabular-and-multidimensional-solutions-ssas).</span><span class="sxs-lookup"><span data-stu-id="8971c-134">For more information, see [Comparing tabular and multidimensional solutions](/sql/analysis-services/comparing-tabular-and-multidimensional-solutions-ssas).</span></span>

<span data-ttu-id="8971c-135">**Power BI**.</span><span class="sxs-lookup"><span data-stu-id="8971c-135">**Power BI**.</span></span> <span data-ttu-id="8971c-136">Power BI es un conjunto de herramientas de análisis de negocios que sirve para analizar datos con el fin de obtener perspectivas empresariales.</span><span class="sxs-lookup"><span data-stu-id="8971c-136">Power BI is a suite of business analytics tools to analyze data for business insights.</span></span> <span data-ttu-id="8971c-137">En el caso de esta arquitectura consulta el modelo semántico almacenado en Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="8971c-137">In this architecture, it queries the semantic model stored in Analysis Services.</span></span>

### <a name="authentication"></a><span data-ttu-id="8971c-138">Autenticación</span><span class="sxs-lookup"><span data-stu-id="8971c-138">Authentication</span></span>

<span data-ttu-id="8971c-139">**Azure Active Directory** (Azure AD) autentica a los usuarios que se conectan al servidor de Analysis Services mediante Power BI.</span><span class="sxs-lookup"><span data-stu-id="8971c-139">**Azure Active Directory** (Azure AD) authenticates users who connect to the Analysis Services server through Power BI.</span></span>

## <a name="data-pipeline"></a><span data-ttu-id="8971c-140">Canalización de datos</span><span class="sxs-lookup"><span data-stu-id="8971c-140">Data pipeline</span></span>
 
<span data-ttu-id="8971c-141">Esta arquitectura de referencia usa la base de datos de ejemplo [WorldWideImporters](/sql/sample/world-wide-importers/wide-world-importers-oltp-database) como origen de datos.</span><span class="sxs-lookup"><span data-stu-id="8971c-141">This reference architecture uses the [WorldWideImporters](/sql/sample/world-wide-importers/wide-world-importers-oltp-database) sample database as a data source.</span></span> <span data-ttu-id="8971c-142">La canalización de datos tiene las siguientes fases:</span><span class="sxs-lookup"><span data-stu-id="8971c-142">The data pipeline has the following stages:</span></span>

1. <span data-ttu-id="8971c-143">Exportación de los datos de SQL Server a archivos planos (utilidad bcp).</span><span class="sxs-lookup"><span data-stu-id="8971c-143">Export the data from SQL Server to flat files (bcp utility).</span></span>
2. <span data-ttu-id="8971c-144">Copia de los archivos planos en Azure Blob Storage (AzCopy).</span><span class="sxs-lookup"><span data-stu-id="8971c-144">Copy the flat files to Azure Blob Storage (AzCopy).</span></span>
3. <span data-ttu-id="8971c-145">Carga de los datos en SQL Data Warehouse (PolyBase).</span><span class="sxs-lookup"><span data-stu-id="8971c-145">Load the data into SQL Data Warehouse (PolyBase).</span></span>
4. <span data-ttu-id="8971c-146">Transformación de los datos en un esquema de estrella (T-SQL).</span><span class="sxs-lookup"><span data-stu-id="8971c-146">Transform the data into a star schema (T-SQL).</span></span>
5. <span data-ttu-id="8971c-147">Carga de un modelo semántico en Analysis Services (SQL Server Data Tools).</span><span class="sxs-lookup"><span data-stu-id="8971c-147">Load a semantic model into Analysis Services (SQL Server Data Tools).</span></span>

![](./images/enterprise-bi-sqldw-pipeline.png)
 
> [!NOTE]
> <span data-ttu-id="8971c-148">Para los pasos del 1 al 3, considere la posibilidad de usar Data Platform Studio de Redgate.</span><span class="sxs-lookup"><span data-stu-id="8971c-148">For steps 1 &ndash; 3, consider using Redgate Data Platform Studio.</span></span> <span data-ttu-id="8971c-149">Data Platform Studio aplica las correcciones y optimizaciones de compatibilidad más adecuadas, por lo que es la forma más rápida de empezar a trabajar con SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="8971c-149">Data Platform Studio applies the most appropriate compatibility fixes and optimizations, so it's the quickest way to get started with SQL Data Warehouse.</span></span> <span data-ttu-id="8971c-150">Para más información consulte [Carga de datos con Data Platform Studio de Redgate](/azure/sql-data-warehouse/sql-data-warehouse-load-with-redgate).</span><span class="sxs-lookup"><span data-stu-id="8971c-150">For more information, see [Load data with Redgate Data Platform Studio](/azure/sql-data-warehouse/sql-data-warehouse-load-with-redgate).</span></span> 

<span data-ttu-id="8971c-151">En las secciones siguientes se describe en detalle cada una de estas etapas.</span><span class="sxs-lookup"><span data-stu-id="8971c-151">The next sections describe these stages in more detail.</span></span>

### <a name="export-data-from-sql-server"></a><span data-ttu-id="8971c-152">Exportación de los datos de SQL Server</span><span class="sxs-lookup"><span data-stu-id="8971c-152">Export data from SQL Server</span></span>

<span data-ttu-id="8971c-153">La utilidad [bcp](/sql/tools/bcp-utility) (programa de copia masiva) es una forma rápida de crear archivos planos de texto a partir de tablas SQL.</span><span class="sxs-lookup"><span data-stu-id="8971c-153">The [bcp](/sql/tools/bcp-utility) (bulk copy program) utility is a fast way to create flat text files from SQL tables.</span></span> <span data-ttu-id="8971c-154">En este paso, seleccione las columnas que desea exportar, pero no transforme los datos.</span><span class="sxs-lookup"><span data-stu-id="8971c-154">In this step, you select the columns that you want to export, but don't transform the data.</span></span> <span data-ttu-id="8971c-155">Las transformaciones de datos deben realizarse en SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="8971c-155">Any data transformations should happen in SQL Data Warehouse.</span></span>

<span data-ttu-id="8971c-156">**Recomendaciones**</span><span class="sxs-lookup"><span data-stu-id="8971c-156">**Recommendations**</span></span>

<span data-ttu-id="8971c-157">Si es posible, programe la extracción de datos durante las horas de poca actividad con el fin de minimizar la contención de recursos en el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="8971c-157">If possible, schedule data extraction during off-peak hours, to minimize resource contention in the production environment.</span></span> 

<span data-ttu-id="8971c-158">Evite ejecutar bcp en el servidor de bases de datos.</span><span class="sxs-lookup"><span data-stu-id="8971c-158">Avoid running bcp on the database server.</span></span> <span data-ttu-id="8971c-159">En su lugar, ejecútelo desde otra máquina.</span><span class="sxs-lookup"><span data-stu-id="8971c-159">Instead, run it from another machine.</span></span> <span data-ttu-id="8971c-160">Escriba los archivos en una unidad local.</span><span class="sxs-lookup"><span data-stu-id="8971c-160">Write the files to a local drive.</span></span> <span data-ttu-id="8971c-161">Asegúrese de que tiene suficientes recursos de E/S para controlar las escrituras simultáneas.</span><span class="sxs-lookup"><span data-stu-id="8971c-161">Ensure that you have sufficient I/O resources to handle the concurrent writes.</span></span> <span data-ttu-id="8971c-162">Para obtener un rendimiento óptimo, exporte los archivos a unidades de almacenamiento rápido dedicadas.</span><span class="sxs-lookup"><span data-stu-id="8971c-162">For best performance, export the files to dedicated fast storage drives.</span></span>

<span data-ttu-id="8971c-163">Puede acelerar la transferencia de red si guarda los datos exportados en un formato comprimido Gzip.</span><span class="sxs-lookup"><span data-stu-id="8971c-163">You can speed up the network transfer by saving the exported data in Gzip compressed format.</span></span> <span data-ttu-id="8971c-164">De todas formas, la carga de archivos comprimidos en el almacenamiento es más lenta que la carga de archivos sin comprimir, por lo que la rapidez en la transferencia de red tiene como contrapartida una menor velocidad en la carga.</span><span class="sxs-lookup"><span data-stu-id="8971c-164">However, loading compressed files into the warehouse is slower than loading uncompressed files, so there is a tradeoff between faster network transfer versus faster loading.</span></span> <span data-ttu-id="8971c-165">Si decide utilizar compresión Gzip, no cree un único archivo Gzip.</span><span class="sxs-lookup"><span data-stu-id="8971c-165">If you decide to use Gzip compression, don't create a single Gzip file.</span></span> <span data-ttu-id="8971c-166">Divida los datos en varios archivos comprimidos.</span><span class="sxs-lookup"><span data-stu-id="8971c-166">Instead, split the data into multiple compressed files.</span></span>

### <a name="copy-flat-files-into-blob-storage"></a><span data-ttu-id="8971c-167">Copia de los archivos planos en Blob Storage</span><span class="sxs-lookup"><span data-stu-id="8971c-167">Copy flat files into blob storage</span></span>

<span data-ttu-id="8971c-168">La utilidad [AzCopy](/azure/storage/common/storage-use-azcopy) está diseñada para la copia de alto rendimiento de datos en Azure Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="8971c-168">The [AzCopy](/azure/storage/common/storage-use-azcopy) utility is designed for high-performance copying of data into Azure blob storage.</span></span>

<span data-ttu-id="8971c-169">**Recomendaciones**</span><span class="sxs-lookup"><span data-stu-id="8971c-169">**Recommendations**</span></span>

<span data-ttu-id="8971c-170">Cree la cuenta de almacenamiento en una región cerca de la ubicación del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="8971c-170">Create the storage account in a region near the location of the source data.</span></span> <span data-ttu-id="8971c-171">Implemente la cuenta de almacenamiento y la instancia de SQL Data Warehouse en la misma región.</span><span class="sxs-lookup"><span data-stu-id="8971c-171">Deploy the storage account and the SQL Data Warehouse instance in the same region.</span></span> 

<span data-ttu-id="8971c-172">No ejecute AzCopy en la misma máquina que ejecuta las cargas de trabajo de producción, ya que el consumo de CPU y E/S puede interferir con la carga de trabajo de producción.</span><span class="sxs-lookup"><span data-stu-id="8971c-172">Don't run AzCopy on the same machine that runs your production workloads, because the CPU and I/O consumption can interfere with the production workload.</span></span> 

<span data-ttu-id="8971c-173">Pruebe la carga primero para ver cómo es la velocidad de carga.</span><span class="sxs-lookup"><span data-stu-id="8971c-173">Test the upload first to see what the upload speed is like.</span></span> <span data-ttu-id="8971c-174">Puede utilizar la opción/NC en AzCopy para especificar el número de operaciones de copia simultáneas.</span><span class="sxs-lookup"><span data-stu-id="8971c-174">You can use the /NC option in AzCopy to specify the number of concurrent copy operations.</span></span> <span data-ttu-id="8971c-175">Comience con el valor predeterminado, a continuación, experimente con este valor para optimizar el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="8971c-175">Start with the default value, then experiment with this setting to tune the performance.</span></span> <span data-ttu-id="8971c-176">En un entorno con poco ancho de banda, demasiadas operaciones simultáneas pueden saturar la conexión de red e impedir que las operaciones se completen con éxito.</span><span class="sxs-lookup"><span data-stu-id="8971c-176">In a low-bandwidth environment, too many concurrent operations can overwhelm the network connection and prevent the operations from completing successfully.</span></span>  

<span data-ttu-id="8971c-177">AzCopy lleva los datos al almacenamiento a través de la red pública de Internet.</span><span class="sxs-lookup"><span data-stu-id="8971c-177">AzCopy moves data to storage over the public internet.</span></span> <span data-ttu-id="8971c-178">Si esto no es lo suficientemente rápido, considere la posibilidad de configurar un circuito [ExpressRoute](/azure/expressroute/).</span><span class="sxs-lookup"><span data-stu-id="8971c-178">If this isn't fast enough, consider setting up an [ExpressRoute](/azure/expressroute/) circuit.</span></span> <span data-ttu-id="8971c-179">ExpressRoute es un servicio que enruta los datos a Azure a través de una conexión privada dedicada.</span><span class="sxs-lookup"><span data-stu-id="8971c-179">ExpressRoute is a service that routes your data through a dedicated private connection to Azure.</span></span> <span data-ttu-id="8971c-180">Otra opción, si la conexión de red es demasiado lenta, es enviar físicamente los datos en un disco a un centro de datos de Azure.</span><span class="sxs-lookup"><span data-stu-id="8971c-180">Another option, if your network connection is too slow, is to physically ship the data on disk to an Azure datacenter.</span></span> <span data-ttu-id="8971c-181">Para más información consulte [Transferencia de datos a Azure y desde este](/azure/architecture/data-guide/scenarios/data-transfer).</span><span class="sxs-lookup"><span data-stu-id="8971c-181">For more information, see [Transferring data to and from Azure](/azure/architecture/data-guide/scenarios/data-transfer).</span></span>

<span data-ttu-id="8971c-182">Durante una operación de copia, AzCopy crea un archivo de diario temporal, lo que permite a AzCopy reiniciar la operación si esta se interrumpiese (por ejemplo, debido a un error de red).</span><span class="sxs-lookup"><span data-stu-id="8971c-182">During a copy operation, AzCopy creates a temporary journal file, which enables AzCopy to restart the operation if it gets interrupted (for example, due to a network error).</span></span> <span data-ttu-id="8971c-183">Asegúrese de que hay suficiente espacio en disco para almacenar los archivos de diario.</span><span class="sxs-lookup"><span data-stu-id="8971c-183">Make sure there is enough disk space to store the journal files.</span></span> <span data-ttu-id="8971c-184">Puede utilizar la opción /Z para especificar dónde se escriben los archivos de diario.</span><span class="sxs-lookup"><span data-stu-id="8971c-184">You can use the /Z option to specify where the journal files are written.</span></span>

### <a name="load-data-into-sql-data-warehouse"></a><span data-ttu-id="8971c-185">Carga de los datos en SQL Data Warehouse</span><span class="sxs-lookup"><span data-stu-id="8971c-185">Load data into SQL Data Warehouse</span></span>

<span data-ttu-id="8971c-186">Use [PolyBase](/sql/relational-databases/polybase/polybase-guide) para cargar los archivos de Blob Storage al almacenamiento de datos.</span><span class="sxs-lookup"><span data-stu-id="8971c-186">Use [PolyBase](/sql/relational-databases/polybase/polybase-guide) to load the files from blob storage into the data warehouse.</span></span> <span data-ttu-id="8971c-187">PolyBase está diseñado para aprovechar la arquitectura MPP (procesamiento masivo en paralelo) de SQL Data Warehouse, lo que lo convierte en la forma más rápida de cargar datos en SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="8971c-187">PolyBase is designed to leverage the MPP (Massively Parallel Processing) architecture of SQL Data Warehouse, which makes it the fastest way to load data into SQL Data Warehouse.</span></span> 

<span data-ttu-id="8971c-188">La carga de datos es un proceso de dos pasos:</span><span class="sxs-lookup"><span data-stu-id="8971c-188">Loading the data is a two-step process:</span></span>

1. <span data-ttu-id="8971c-189">Creación de un conjunto de tablas externas para los datos.</span><span class="sxs-lookup"><span data-stu-id="8971c-189">Create a set of external tables for the data.</span></span> <span data-ttu-id="8971c-190">Una tabla externa es una definición de tabla que apunta a los datos almacenados fuera del almacén &mdash; en este caso, a los archivos planos en Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="8971c-190">An external table is a table definition that points to data stored outside of the warehouse &mdash; in this case, the flat files in blob storage.</span></span> <span data-ttu-id="8971c-191">Este paso no mueve ningún dato al almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="8971c-191">This step does not move any data into the warehouse.</span></span>
2. <span data-ttu-id="8971c-192">Creación de tablas de almacenamiento provisional y carga de los datos en las tablas de almacenamiento provisional.</span><span class="sxs-lookup"><span data-stu-id="8971c-192">Create staging tables, and load the data into the staging tables.</span></span> <span data-ttu-id="8971c-193">Este paso copia los datos en el almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="8971c-193">This step copies the data into the warehouse.</span></span>

<span data-ttu-id="8971c-194">**Recomendaciones**</span><span class="sxs-lookup"><span data-stu-id="8971c-194">**Recommendations**</span></span>

<span data-ttu-id="8971c-195">Considere la posibilidad de usar SQL Data Warehouse cuando tenga grandes cantidades de datos (más de 1 TB) y esté ejecutando una carga de trabajo de análisis que aprovecharía el paralelismo.</span><span class="sxs-lookup"><span data-stu-id="8971c-195">Consider SQL Data Warehouse when you have large amounts of data (more than 1 TB) and are running an analytics workload that will benefit from parallelism.</span></span> <span data-ttu-id="8971c-196">SQL Data Warehouse no es una buena opción para cargas de trabajo OLTP o conjuntos de datos más pequeños (< 250 GB).</span><span class="sxs-lookup"><span data-stu-id="8971c-196">SQL Data Warehouse is not a good fit for OLTP workloads or smaller data sets (< 250GB).</span></span> <span data-ttu-id="8971c-197">Para conjuntos de datos de un tamaño inferior a 250 GB, considere la posibilidad de usar Azure SQL Database o SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8971c-197">For data sets less than 250GB, consider Azure SQL Database or SQL Server.</span></span> <span data-ttu-id="8971c-198">Para más información, consulte el artículo sobre [Almacenamiento de datos](../../data-guide/relational-data/data-warehousing.md).</span><span class="sxs-lookup"><span data-stu-id="8971c-198">For more information, see [Data warehousing](../../data-guide/relational-data/data-warehousing.md).</span></span>

<span data-ttu-id="8971c-199">Cree las tablas de almacenamiento provisional como tablas de montón, que no están indexadas.</span><span class="sxs-lookup"><span data-stu-id="8971c-199">Create the staging tables as heap tables, which are not indexed.</span></span> <span data-ttu-id="8971c-200">Las consultas que crean las tablas de producción darán como resultado un examen completo de la tabla, así que no hay ninguna razón para indexar las tablas de almacenamiento provisional.</span><span class="sxs-lookup"><span data-stu-id="8971c-200">The queries that create the production tables will result in a full table scan, so there is no reason to index the staging tables.</span></span>

<span data-ttu-id="8971c-201">PolyBase aprovecha automáticamente las ventajas del paralelismo en el almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="8971c-201">PolyBase automatically takes advantage of parallelism in the warehouse.</span></span> <span data-ttu-id="8971c-202">El rendimiento de carga se escala a medida que aumentan las unidades de almacenamiento de datos.</span><span class="sxs-lookup"><span data-stu-id="8971c-202">The load performance scales as you increase DWUs.</span></span> <span data-ttu-id="8971c-203">Para obtener el mejor rendimiento, utilice una operación de carga única.</span><span class="sxs-lookup"><span data-stu-id="8971c-203">For best performance, use a single load operation.</span></span> <span data-ttu-id="8971c-204">Dividir los datos de entrada en fragmentos y ejecutar varias cargas simultáneas no beneficia al rendimiento.</span><span class="sxs-lookup"><span data-stu-id="8971c-204">There is no performance benefit to breaking the input data into chunks and running multiple concurrent loads.</span></span>

<span data-ttu-id="8971c-205">PolyBase puede leer archivos comprimidos con Gzip.</span><span class="sxs-lookup"><span data-stu-id="8971c-205">PolyBase can read Gzip compressed files.</span></span> <span data-ttu-id="8971c-206">De todas formas, se usa un lector único por archivo comprimido, porque descomprimir el archivo es una operación de un solo subproceso.</span><span class="sxs-lookup"><span data-stu-id="8971c-206">However, only a single reader is used per compressed file, because uncompressing the file is a single-threaded operation.</span></span> <span data-ttu-id="8971c-207">Por ello, evite cargar un único archivo comprimido grande.</span><span class="sxs-lookup"><span data-stu-id="8971c-207">Therefore, avoid loading a single large compressed file.</span></span> <span data-ttu-id="8971c-208">En su lugar, divida los datos en varios archivos comprimidos, para aprovechar las ventajas del paralelismo.</span><span class="sxs-lookup"><span data-stu-id="8971c-208">Instead, split the data into multiple compressed files, in order to take advantage of parallelism.</span></span> 

<span data-ttu-id="8971c-209">Tenga en cuenta las siguientes limitaciones:</span><span class="sxs-lookup"><span data-stu-id="8971c-209">Be aware of the following limitations:</span></span>

- <span data-ttu-id="8971c-210">PolyBase admite un tamaño máximo de columna de `varchar(8000)`, `nvarchar(4000)` o `varbinary(8000)`.</span><span class="sxs-lookup"><span data-stu-id="8971c-210">PolyBase supports a maximum column size of `varchar(8000)`, `nvarchar(4000)`, or `varbinary(8000)`.</span></span> <span data-ttu-id="8971c-211">Si tiene datos que superan estos límites, tiene la opción de dividir los datos en fragmentos al exportarlos y luego volver a ensamblar los fragmentos tras la importación.</span><span class="sxs-lookup"><span data-stu-id="8971c-211">If you have data that exceeds these limits, one option is to break the data up into chunks when you export it, and then reassemble the chunks after import.</span></span> 

- <span data-ttu-id="8971c-212">PolyBase usa un terminador de fila fijo de \n o una línea nueva.</span><span class="sxs-lookup"><span data-stu-id="8971c-212">PolyBase uses a fixed row terminator of \n or newline.</span></span> <span data-ttu-id="8971c-213">Esto puede causar problemas si los caracteres de nueva línea aparecen en los datos de origen.</span><span class="sxs-lookup"><span data-stu-id="8971c-213">This can cause problems if newline characters appear in the source data.</span></span>

- <span data-ttu-id="8971c-214">El esquema de origen de datos podría contener tipos de datos que SQL Data Warehouse no admite.</span><span class="sxs-lookup"><span data-stu-id="8971c-214">Your source data schema might contain data types that are not supported in SQL Data Warehouse.</span></span>

<span data-ttu-id="8971c-215">Para evitar estas limitaciones, puede crear un procedimiento almacenado que realiza las conversiones necesarias.</span><span class="sxs-lookup"><span data-stu-id="8971c-215">To work around these limitations, you can create a stored procedure that performs the necessary conversions.</span></span> <span data-ttu-id="8971c-216">Haga referencia a este procedimiento almacenado cuando ejecute bcp.</span><span class="sxs-lookup"><span data-stu-id="8971c-216">Reference this stored procedure when you run bcp.</span></span> <span data-ttu-id="8971c-217">De forma alternativa, [Data Platform Studio de Redgate](/azure/sql-data-warehouse/sql-data-warehouse-load-with-redgate) convierte automáticamente los tipos de datos que SQL Data Warehouse no admite.</span><span class="sxs-lookup"><span data-stu-id="8971c-217">Alternatively, [Redgate Data Platform Studio](/azure/sql-data-warehouse/sql-data-warehouse-load-with-redgate) automatically converts data types that aren’t supported in SQL Data Warehouse.</span></span>

<span data-ttu-id="8971c-218">Para más información, consulte los siguientes artículos.</span><span class="sxs-lookup"><span data-stu-id="8971c-218">For more information, see the following articles:</span></span>

- <span data-ttu-id="8971c-219">[Procedimientos recomendados para la carga de datos en Azure SQL Data Warehouse](/azure/sql-data-warehouse/guidance-for-loading-data).</span><span class="sxs-lookup"><span data-stu-id="8971c-219">[Best practices for loading data into Azure SQL Data Warehouse](/azure/sql-data-warehouse/guidance-for-loading-data).</span></span>
- [<span data-ttu-id="8971c-220">Migración de esquemas a SQL Data Warehouse</span><span class="sxs-lookup"><span data-stu-id="8971c-220">Migrate your schemas to SQL Data Warehouse</span></span>](/azure/sql-data-warehouse/sql-data-warehouse-migrate-schema)
- [<span data-ttu-id="8971c-221">Guía para definir los tipos de datos para las tablas en SQL Data Warehouse</span><span class="sxs-lookup"><span data-stu-id="8971c-221">Guidance for defining data types for tables in SQL Data Warehouse</span></span>](/azure/sql-data-warehouse/sql-data-warehouse-tables-data-types)

### <a name="transform-the-data"></a><span data-ttu-id="8971c-222">Transformar los datos</span><span class="sxs-lookup"><span data-stu-id="8971c-222">Transform the data</span></span>

<span data-ttu-id="8971c-223">Transforme los datos y muévalos a tablas de producción.</span><span class="sxs-lookup"><span data-stu-id="8971c-223">Transform the data and move it into production tables.</span></span> <span data-ttu-id="8971c-224">En este paso, los datos se transforman en un esquema en estrella con tablas de dimensiones y tablas de hechos, adecuadas para el modelado semántico.</span><span class="sxs-lookup"><span data-stu-id="8971c-224">In this step, the data is transformed into a star schema with dimension tables and fact tables, suitable for semantic modeling.</span></span>

<span data-ttu-id="8971c-225">Cree las tablas de producción con índices de almacén de columnas en clúster que ofrecen el mejor rendimiento general para las consultas.</span><span class="sxs-lookup"><span data-stu-id="8971c-225">Create the production tables with clustered columnstore indexes, which offer the best overall query performance.</span></span> <span data-ttu-id="8971c-226">Los índices de almacén de columnas están optimizados para consultas que examinan muchos registros.</span><span class="sxs-lookup"><span data-stu-id="8971c-226">Columnstore indexes are optimized for queries that scan many records.</span></span> <span data-ttu-id="8971c-227">Sin embargo no funcionan tan bien para las búsquedas singleton (es decir aquellas en las que la búsqueda se reduce a una sola fila).</span><span class="sxs-lookup"><span data-stu-id="8971c-227">Columnstore indexes don't perform as well for singleton lookups (that is, looking up a single row).</span></span> <span data-ttu-id="8971c-228">Si tiene que realizar búsquedas singleton frecuentes, puede agregar un índice no agrupado en una tabla.</span><span class="sxs-lookup"><span data-stu-id="8971c-228">If you need to perform frequent singleton lookups, you can add a non-clustered index to a table.</span></span> <span data-ttu-id="8971c-229">Este tipo de búsquedas pueden ejecutarse de forma considerablemente más rápida usando un índice no agrupado.</span><span class="sxs-lookup"><span data-stu-id="8971c-229">Singleton lookups can run significantly faster using a non-clustered index.</span></span> <span data-ttu-id="8971c-230">De todas formas, las búsquedas singleton son normalmente menos comunes en escenarios de almacenamiento de datos que las cargas de trabajo OLTP.</span><span class="sxs-lookup"><span data-stu-id="8971c-230">However, singleton lookups are typically less common in data warehouse scenarios than OLTP workloads.</span></span> <span data-ttu-id="8971c-231">Para más información, consulte [Indexación de tablas en SQL Data Warehouse](/azure/sql-data-warehouse/sql-data-warehouse-tables-index).</span><span class="sxs-lookup"><span data-stu-id="8971c-231">For more information, see [Indexing tables in SQL Data Warehouse](/azure/sql-data-warehouse/sql-data-warehouse-tables-index).</span></span>

> [!NOTE]
> <span data-ttu-id="8971c-232">Las tablas de almacén de columnas agrupado no admiten tipos de datos `varchar(max)`, `nvarchar(max)` o `varbinary(max)`.</span><span class="sxs-lookup"><span data-stu-id="8971c-232">Clustered columnstore tables do not support `varchar(max)`, `nvarchar(max)`, or `varbinary(max)` data types.</span></span> <span data-ttu-id="8971c-233">En ese caso, considere la posibilidad de un índice agrupado o de montón.</span><span class="sxs-lookup"><span data-stu-id="8971c-233">In that case, consider a heap or clustered index.</span></span> <span data-ttu-id="8971c-234">Puede colocar esas columnas en una tabla independiente.</span><span class="sxs-lookup"><span data-stu-id="8971c-234">You might put those columns into a separate table.</span></span>

<span data-ttu-id="8971c-235">Dado que la base de datos de ejemplo no es muy grande, hemos creado las tablas replicadas sin particiones.</span><span class="sxs-lookup"><span data-stu-id="8971c-235">Because the sample database is not very large, we created replicated tables with no partitions.</span></span> <span data-ttu-id="8971c-236">Para las cargas de trabajo de producción, el uso de tablas distribuidas probablemente mejore el rendimiento de las consultas.</span><span class="sxs-lookup"><span data-stu-id="8971c-236">For production workloads, using distributed tables is likely to improve query performance.</span></span> <span data-ttu-id="8971c-237">Consulte [Instrucciones para diseñar tablas distribuidas en Azure SQL Data Warehouse](/azure/sql-data-warehouse/sql-data-warehouse-tables-distribute).</span><span class="sxs-lookup"><span data-stu-id="8971c-237">See [Guidance for designing distributed tables in Azure SQL Data Warehouse](/azure/sql-data-warehouse/sql-data-warehouse-tables-distribute).</span></span> <span data-ttu-id="8971c-238">Los scripts de ejemplo ejecutan las consultas utilizando una [clase de recursos](/azure/sql-data-warehouse/resource-classes-for-workload-management) estática.</span><span class="sxs-lookup"><span data-stu-id="8971c-238">Our example scripts run the queries using a static [resource class](/azure/sql-data-warehouse/resource-classes-for-workload-management).</span></span>

### <a name="load-the-semantic-model"></a><span data-ttu-id="8971c-239">Carga del modelo semántico</span><span class="sxs-lookup"><span data-stu-id="8971c-239">Load the semantic model</span></span>

<span data-ttu-id="8971c-240">Cargue los datos en un modelo tabular en Azure Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="8971c-240">Load the data into a tabular model in Azure Analysis Services.</span></span> <span data-ttu-id="8971c-241">En este paso, creará un modelo de datos semánticos usando SQL Server Data Tools (SSDT).</span><span class="sxs-lookup"><span data-stu-id="8971c-241">In this step, you create a semantic data model by using SQL Server Data Tools (SSDT).</span></span> <span data-ttu-id="8971c-242">También puede crear un modelo mediante la importación desde un archivo de Power BI Desktop.</span><span class="sxs-lookup"><span data-stu-id="8971c-242">You can also create a model by importing it from a Power BI Desktop file.</span></span> <span data-ttu-id="8971c-243">Teniendo en cuenta que SQL Data Warehouse no admite las claves externas, tiene que agregar las relaciones al modelo semántico para que se puedan realizar uniones entre las tablas.</span><span class="sxs-lookup"><span data-stu-id="8971c-243">Because SQL Data Warehouse does not support foreign keys, you must add the relationships to the semantic model, so that you can join across tables.</span></span>

### <a name="use-power-bi-to-visualize-the-data"></a><span data-ttu-id="8971c-244">Uso de Power BI para visualizar los datos</span><span class="sxs-lookup"><span data-stu-id="8971c-244">Use Power BI to visualize the data</span></span>

<span data-ttu-id="8971c-245">Power BI admite dos opciones para la conexión a Azure Analysis Services:</span><span class="sxs-lookup"><span data-stu-id="8971c-245">Power BI supports two options for connecting to Azure Analysis Services:</span></span>

- <span data-ttu-id="8971c-246">Importación.</span><span class="sxs-lookup"><span data-stu-id="8971c-246">Import.</span></span> <span data-ttu-id="8971c-247">Se importan los datos en el modelo BI.</span><span class="sxs-lookup"><span data-stu-id="8971c-247">The data is imported into the Power BI model.</span></span>
- <span data-ttu-id="8971c-248">Conexión dinámica.</span><span class="sxs-lookup"><span data-stu-id="8971c-248">Live Connection.</span></span> <span data-ttu-id="8971c-249">Se extraen los datos directamente desde Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="8971c-249">Data is pulled directly from Analysis Services.</span></span>

<span data-ttu-id="8971c-250">Se recomienda la conexión dinámica, ya que no requiere copiar los datos en el modelo de Power BI.</span><span class="sxs-lookup"><span data-stu-id="8971c-250">We recommend Live Connection because it doesn't require copying data into the Power BI model.</span></span> <span data-ttu-id="8971c-251">Además, al usar DirectQuery se garantiza que los resultados siempre sean coherentes con los últimos datos de origen.</span><span class="sxs-lookup"><span data-stu-id="8971c-251">Also, using DirectQuery ensures that results are always consistent with the latest source data.</span></span> <span data-ttu-id="8971c-252">Para más información, consulte [Conexión con Power BI](/azure/analysis-services/analysis-services-connect-pbi).</span><span class="sxs-lookup"><span data-stu-id="8971c-252">For more information, see [Connect with Power BI](/azure/analysis-services/analysis-services-connect-pbi).</span></span>

<span data-ttu-id="8971c-253">**Recomendaciones**</span><span class="sxs-lookup"><span data-stu-id="8971c-253">**Recommendations**</span></span>

<span data-ttu-id="8971c-254">Evite ejecutar consultas de panel de BI directamente en el almacenamiento de datos.</span><span class="sxs-lookup"><span data-stu-id="8971c-254">Avoid running BI dashboard queries directly against the data warehouse.</span></span> <span data-ttu-id="8971c-255">Los paneles BI requieren tiempos de respuesta muy bajos, es posible que las consultas directas realizadas en el almacenamiento no pueden satisfacer esta necesidad.</span><span class="sxs-lookup"><span data-stu-id="8971c-255">BI dashboards require very low response times, which direct queries against the warehouse may be unable to satisfy.</span></span> <span data-ttu-id="8971c-256">Además, la actualización del panel se reflejará en el número de consultas simultáneas, lo que podría afectar al rendimiento.</span><span class="sxs-lookup"><span data-stu-id="8971c-256">Also, refreshing the dashboard will count against the number of concurrent queries, which could impact performance.</span></span> 

<span data-ttu-id="8971c-257">Azure Analysis Services está diseñado para controlar los requisitos de consulta de un panel de BI, por lo que es el método recomendado es consultar Analysis Services desde Power BI.</span><span class="sxs-lookup"><span data-stu-id="8971c-257">Azure Analysis Services is designed to handle the query requirements of a BI dashboard, so the recommended practice is to query Analysis Services from Power BI.</span></span>

## <a name="scalability-considerations"></a><span data-ttu-id="8971c-258">Consideraciones sobre escalabilidad</span><span class="sxs-lookup"><span data-stu-id="8971c-258">Scalability considerations</span></span>

### <a name="sql-data-warehouse"></a><span data-ttu-id="8971c-259">SQL Data Warehouse</span><span class="sxs-lookup"><span data-stu-id="8971c-259">SQL Data Warehouse</span></span>

<span data-ttu-id="8971c-260">Con SQL Data Warehouse, puede escalar horizontalmente los recursos de proceso a petición.</span><span class="sxs-lookup"><span data-stu-id="8971c-260">With SQL Data Warehouse, you can scale out your compute resources on demand.</span></span> <span data-ttu-id="8971c-261">El motor de consultas optimiza las consultas para el procesamiento paralelo en función del número de nodos de ejecución y mueve los datos entre los nodos según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="8971c-261">The query engine optimizes queries for parallel processing based on the number of compute nodes, and moves data between nodes as necessary.</span></span> <span data-ttu-id="8971c-262">Para más información consulte [Administración de proceso en Azure SQL Data Warehouse](/azure/sql-data-warehouse/sql-data-warehouse-manage-compute-overview).</span><span class="sxs-lookup"><span data-stu-id="8971c-262">For more information, see [Manage compute in Azure SQL Data Warehouse](/azure/sql-data-warehouse/sql-data-warehouse-manage-compute-overview).</span></span>

### <a name="analysis-services"></a><span data-ttu-id="8971c-263">Analysis Services</span><span class="sxs-lookup"><span data-stu-id="8971c-263">Analysis Services</span></span>

<span data-ttu-id="8971c-264">Para las cargas de trabajo de producción, se recomienda el nivel estándar para Azure Analysis Services, ya que admite la creación de particiones y DirectQuery.</span><span class="sxs-lookup"><span data-stu-id="8971c-264">For production workloads, we recommend the Standard Tier for Azure Analysis Services, because it supports partitioning and DirectQuery.</span></span> <span data-ttu-id="8971c-265">Dentro de un nivel, el tamaño de la instancia determina la memoria y potencia de procesamiento.</span><span class="sxs-lookup"><span data-stu-id="8971c-265">Within a tier, the instance size determines the memory and processing power.</span></span> <span data-ttu-id="8971c-266">La capacidad de procesamiento se mide en unidades de procesamiento de consultas (QPU).</span><span class="sxs-lookup"><span data-stu-id="8971c-266">Processing power is measured in Query Processing Units (QPUs).</span></span> <span data-ttu-id="8971c-267">Supervise el uso de las QPU para seleccionar el tamaño adecuado.</span><span class="sxs-lookup"><span data-stu-id="8971c-267">Monitor your QPU usage to select the appropriate size.</span></span> <span data-ttu-id="8971c-268">Para más información, consulte [Supervisión de las métricas del servidor](/azure/analysis-services/analysis-services-monitor).</span><span class="sxs-lookup"><span data-stu-id="8971c-268">For more information, see [Monitor server metrics](/azure/analysis-services/analysis-services-monitor).</span></span>

<span data-ttu-id="8971c-269">Bajo una carga alta, el rendimiento de las consultas se puede ver degradado debido a la simultaneidad de las mismas.</span><span class="sxs-lookup"><span data-stu-id="8971c-269">Under high load, query performance can become degraded due to query concurrency.</span></span> <span data-ttu-id="8971c-270">Puede escalar horizontalmente Analysis Services mediante la creación de un grupo de réplicas para procesar las consultas, para que se pueden realizar más consultas simultáneamente.</span><span class="sxs-lookup"><span data-stu-id="8971c-270">You can scale out Analysis Services by creating a pool of replicas to process queries, so that more queries can be performed concurrently.</span></span> <span data-ttu-id="8971c-271">El trabajo de procesar el modelo de datos siempre se produce en el servidor principal.</span><span class="sxs-lookup"><span data-stu-id="8971c-271">The work of processing the data model always happens on the primary server.</span></span> <span data-ttu-id="8971c-272">De forma predeterminada, el servidor principal también controla las consultas.</span><span class="sxs-lookup"><span data-stu-id="8971c-272">By default, the primary server also handles queries.</span></span> <span data-ttu-id="8971c-273">Si lo desea, puede designar al servidor principal para que ejecute el procesamiento de modo exclusivo, de modo que el grupo de consulta controle todas las consultas.</span><span class="sxs-lookup"><span data-stu-id="8971c-273">Optionally, you can designate the primary server to run processing exclusively, so that the query pool handles all queries.</span></span> <span data-ttu-id="8971c-274">Si los requisitos de procesamiento son altos, debe separar el procesamiento del grupo de consulta.</span><span class="sxs-lookup"><span data-stu-id="8971c-274">If you have high processing requirements, you should separate the processing from the query pool.</span></span> <span data-ttu-id="8971c-275">Si tiene cargas de consulta elevadas, y un procesamiento relativamente ligero, puede incluir el servidor principal en el grupo de consulta.</span><span class="sxs-lookup"><span data-stu-id="8971c-275">If you have high query loads, and relatively light processing, you can include the primary server in the query pool.</span></span> <span data-ttu-id="8971c-276">Para más información consulte [Escalabilidad horizontal de Azure Analysis Services](/azure/analysis-services/analysis-services-scale-out).</span><span class="sxs-lookup"><span data-stu-id="8971c-276">For more information, see [Azure Analysis Services scale-out](/azure/analysis-services/analysis-services-scale-out).</span></span> 

<span data-ttu-id="8971c-277">Para reducir la cantidad de procesamiento innecesario, considere la posibilidad de utilizar particiones para dividir el modelo tabular en partes lógicas.</span><span class="sxs-lookup"><span data-stu-id="8971c-277">To reduce the amount of unnecessary processing, consider using partitions to divide the tabular model into logical parts.</span></span> <span data-ttu-id="8971c-278">Cada partición se puede procesar por separado.</span><span class="sxs-lookup"><span data-stu-id="8971c-278">Each partition can be processed separately.</span></span> <span data-ttu-id="8971c-279">Para más información consulte [Particiones](/sql/analysis-services/tabular-models/partitions-ssas-tabular).</span><span class="sxs-lookup"><span data-stu-id="8971c-279">For more information, see [Partitions](/sql/analysis-services/tabular-models/partitions-ssas-tabular).</span></span>

## <a name="security-considerations"></a><span data-ttu-id="8971c-280">Consideraciones sobre la seguridad</span><span class="sxs-lookup"><span data-stu-id="8971c-280">Security considerations</span></span>

### <a name="ip-whitelisting-of-analysis-services-clients"></a><span data-ttu-id="8971c-281">Creación de listas de direcciones IP permitidas de clientes de Analysis Services</span><span class="sxs-lookup"><span data-stu-id="8971c-281">IP whitelisting of Analysis Services clients</span></span>

<span data-ttu-id="8971c-282">Considere el uso de la característica de firewall de Analysis Services para crear una lista de direcciones IP permitidas de clientes.</span><span class="sxs-lookup"><span data-stu-id="8971c-282">Consider using the Analysis Services firewall feature to whitelist client IP addresses.</span></span> <span data-ttu-id="8971c-283">Cuando está habilitada, la característica de firewall bloquea todas las conexiones de cliente a excepción de las especificadas en las reglas de firewall.</span><span class="sxs-lookup"><span data-stu-id="8971c-283">If enabled, the firewall blocks all client connections other than those specified in the firewall rules.</span></span> <span data-ttu-id="8971c-284">El servicio Power BI se encuentra en la lista de permitidos de forma predeterminada, pero se puede deshabilitar esta regla si lo desea.</span><span class="sxs-lookup"><span data-stu-id="8971c-284">The default rules whitelist the Power BI service, but you can disable this rule if desired.</span></span> <span data-ttu-id="8971c-285">Para más información, consulte [Hardening Azure Analysis Services with the new firewall capability](https://azure.microsoft.com/blog/hardening-azure-analysis-services-with-the-new-firewall-capability/) (Protección de Azure Analysis Services con la nueva funcionalidad de firewall).</span><span class="sxs-lookup"><span data-stu-id="8971c-285">For more information, see [Hardening Azure Analysis Services with the new firewall capability](https://azure.microsoft.com/blog/hardening-azure-analysis-services-with-the-new-firewall-capability/).</span></span>

### <a name="authorization"></a><span data-ttu-id="8971c-286">Autorización</span><span class="sxs-lookup"><span data-stu-id="8971c-286">Authorization</span></span>

<span data-ttu-id="8971c-287">Azure Analysis Services usa Azure Active Directory (Azure AD) para autenticar a los usuarios que se conectan a un servidor de Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="8971c-287">Azure Analysis Services uses Azure Active Directory (Azure AD) to authenticate users who connect to an Analysis Services server.</span></span> <span data-ttu-id="8971c-288">Puede restringir los datos que un usuario determinado puede ver mediante la creación de roles, y después asignar grupos o usuarios de Azure AD a esos roles.</span><span class="sxs-lookup"><span data-stu-id="8971c-288">You can restrict what data a particular user is able to view, by creating roles and then assigning Azure AD users or groups to those roles.</span></span> <span data-ttu-id="8971c-289">Para cada rol puede hacer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="8971c-289">For each role, you can:</span></span> 

- <span data-ttu-id="8971c-290">Proteger las tablas o columnas individuales.</span><span class="sxs-lookup"><span data-stu-id="8971c-290">Protect tables or individual columns.</span></span> 
- <span data-ttu-id="8971c-291">Proteger filas individuales en base a expresiones de filtro.</span><span class="sxs-lookup"><span data-stu-id="8971c-291">Protect individual rows based on filter expressions.</span></span> 

<span data-ttu-id="8971c-292">Para más información, consulte [Administración de usuarios y roles de base de datos](/azure/analysis-services/analysis-services-database-users).</span><span class="sxs-lookup"><span data-stu-id="8971c-292">For more information, see [Manage database roles and users](/azure/analysis-services/analysis-services-database-users).</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="8971c-293">Implementación de la solución</span><span class="sxs-lookup"><span data-stu-id="8971c-293">Deploy the solution</span></span>

<span data-ttu-id="8971c-294">Hay disponible una implementación de esta arquitectura de referencia en [GitHub][ref-arch-repo-folder].</span><span class="sxs-lookup"><span data-stu-id="8971c-294">A deployment for this reference architecture is available on [GitHub][ref-arch-repo-folder].</span></span> <span data-ttu-id="8971c-295">Implementa lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="8971c-295">It deploys the following:</span></span>

  * <span data-ttu-id="8971c-296">Una máquina virtual Windows para simular un servidor de bases de datos local.</span><span class="sxs-lookup"><span data-stu-id="8971c-296">A Windows VM to simulate an on-premises database server.</span></span> <span data-ttu-id="8971c-297">Incluye SQL Server 2017 y herramientas relacionadas, junto con Power BI Desktop.</span><span class="sxs-lookup"><span data-stu-id="8971c-297">It includes SQL Server 2017 and related tools, along with Power BI Desktop.</span></span>
  * <span data-ttu-id="8971c-298">Una cuenta de almacenamiento de Azure que proporciona almacenamiento de blobs para almacenar los datos exportados de la base de datos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8971c-298">An Azure storage account that provides Blob storage to hold data exported from the SQL Server database.</span></span>
  * <span data-ttu-id="8971c-299">Una instancia de Azure SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="8971c-299">An Azure SQL Data Warehouse instance.</span></span>
  * <span data-ttu-id="8971c-300">Una instancia de Azure Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="8971c-300">An Azure Analysis Services instance.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="8971c-301">requisitos previos</span><span class="sxs-lookup"><span data-stu-id="8971c-301">Prerequisites</span></span>

[!INCLUDE [ref-arch-prerequisites.md](../../../includes/ref-arch-prerequisites.md)]

### <a name="deploy-the-simulated-on-premises-server"></a><span data-ttu-id="8971c-302">Implementación del servidor local simulado</span><span class="sxs-lookup"><span data-stu-id="8971c-302">Deploy the simulated on-premises server</span></span>

<span data-ttu-id="8971c-303">En primer lugar va a implementar una máquina virtual como un servidor local simulado, que incluye SQL Server 2017 y las herramientas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="8971c-303">First you'll deploy a VM as a simulated on-premises server, which includes SQL Server 2017 and related tools.</span></span> <span data-ttu-id="8971c-304">Este paso también carga la [base de datos OLTP Wide World Importers][wwi] en SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8971c-304">This step also loads the [Wide World Importers OLTP database][wwi] into SQL Server.</span></span>

1. <span data-ttu-id="8971c-305">Vaya a la carpeta `data\enterprise_bi_sqldw\onprem\templates` del repositorio.</span><span class="sxs-lookup"><span data-stu-id="8971c-305">Navigate to the `data\enterprise_bi_sqldw\onprem\templates` folder of the repository.</span></span>

2. <span data-ttu-id="8971c-306">En el archivo `onprem.parameters.json` reemplace los valores de `adminUsername` y `adminPassword`.</span><span class="sxs-lookup"><span data-stu-id="8971c-306">In the `onprem.parameters.json` file, replace the values for `adminUsername` and `adminPassword`.</span></span> <span data-ttu-id="8971c-307">Cambie también los valores en la sección `SqlUserCredentials` para que coincidan con el nombre de usuario y la contraseña.</span><span class="sxs-lookup"><span data-stu-id="8971c-307">Also change the values in the `SqlUserCredentials` section to match the user name and password.</span></span> <span data-ttu-id="8971c-308">Tenga en cuenta el prefijo `.\\` en la propiedad de nombre de usuario.</span><span class="sxs-lookup"><span data-stu-id="8971c-308">Note the `.\\` prefix in the userName property.</span></span>
    
    ```bash
    "SqlUserCredentials": {
      "userName": ".\\username",
      "password": "password"
    }
    ```

3. <span data-ttu-id="8971c-309">Ejecute `azbb` tal y como se muestra a continuación para implementar el servidor local.</span><span class="sxs-lookup"><span data-stu-id="8971c-309">Run `azbb` as shown below to deploy the on-premises server.</span></span>

    ```bash
    azbb -s <subscription_id> -g <resource_group_name> -l <region> -p onprem.parameters.json --deploy
    ```

    <span data-ttu-id="8971c-310">Especifique una región que admita SQL Data Warehouse y Azure Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="8971c-310">Specify a region that supports SQL Data Warehouse and Azure Analysis Services.</span></span> <span data-ttu-id="8971c-311">Consulte [Productos de Azure por región](https://azure.microsoft.com/global-infrastructure/services/)</span><span class="sxs-lookup"><span data-stu-id="8971c-311">See [Azure Products by Region](https://azure.microsoft.com/global-infrastructure/services/)</span></span>

4. <span data-ttu-id="8971c-312">La implementación puede tardar de 20 a 30 minutos en completarse, lo que incluye ejecutar el script [DSC](/powershell/dsc/overview) para instalar las herramientas y restaurar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="8971c-312">The deployment may take 20 to 30 minutes to complete, which includes running the [DSC](/powershell/dsc/overview) script to install the tools and restore the database.</span></span> <span data-ttu-id="8971c-313">Compruebe la implementación en Azure Portal revisando los recursos del grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="8971c-313">Verify the deployment in the Azure portal by reviewing the resources in the resource group.</span></span> <span data-ttu-id="8971c-314">Debería ver la máquina virtual `sql-vm1` y sus recursos asociados.</span><span class="sxs-lookup"><span data-stu-id="8971c-314">You should see the `sql-vm1` virtual machine and its associated resources.</span></span>

### <a name="deploy-the-azure-resources"></a><span data-ttu-id="8971c-315">Implementación de los recursos de Azure</span><span class="sxs-lookup"><span data-stu-id="8971c-315">Deploy the Azure resources</span></span>

<span data-ttu-id="8971c-316">Este paso aprovisiona SQL Data Warehouse y Azure Analysis Services, junto con una cuenta de Storage.</span><span class="sxs-lookup"><span data-stu-id="8971c-316">This step provisions SQL Data Warehouse and Azure Analysis Services, along with a Storage account.</span></span> <span data-ttu-id="8971c-317">Si lo desea, puede ejecutar este paso en paralelo con el paso anterior.</span><span class="sxs-lookup"><span data-stu-id="8971c-317">If you want, you can run this step in parallel with the previous step.</span></span>

1. <span data-ttu-id="8971c-318">Vaya a la carpeta `data\enterprise_bi_sqldw\azure\templates` del repositorio.</span><span class="sxs-lookup"><span data-stu-id="8971c-318">Navigate to the `data\enterprise_bi_sqldw\azure\templates` folder of the repository.</span></span>

2. <span data-ttu-id="8971c-319">Ejecute el siguiente comando de la CLI de Azure para crear un grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="8971c-319">Run the following Azure CLI command to create a resource group.</span></span> <span data-ttu-id="8971c-320">Puede realizar la implementación en un grupo de recursos diferente que el paso anterior, pero elegir la misma región.</span><span class="sxs-lookup"><span data-stu-id="8971c-320">You can deploy to a different resource group than the previous step, but choose the same region.</span></span> 

    ```bash
    az group create --name <resource_group_name> --location <region>  
    ```

3. <span data-ttu-id="8971c-321">Ejecute el siguiente comando de la CLI de Azure para implementar los recursos de Azure.</span><span class="sxs-lookup"><span data-stu-id="8971c-321">Run the following Azure CLI command to deploy the Azure resources.</span></span> <span data-ttu-id="8971c-322">Reemplace los valores del parámetro que se muestran entre paréntesis angulares.</span><span class="sxs-lookup"><span data-stu-id="8971c-322">Replace the parameter values shown in angle brackets.</span></span> 

    ```bash
    az group deployment create --resource-group <resource_group_name> \
     --template-file azure-resources-deploy.json \
     --parameters "dwServerName"="<server_name>" \
     "dwAdminLogin"="<admin_username>" "dwAdminPassword"="<password>" \ 
     "storageAccountName"="<storage_account_name>" \
     "analysisServerName"="<analysis_server_name>" \
     "analysisServerAdmin"="user@contoso.com"
    ```

    - <span data-ttu-id="8971c-323">El parámetro `storageAccountName` tiene que seguir las [reglas de nomenclatura](../../best-practices/naming-conventions.md#naming-rules-and-restrictions) para las cuentas de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="8971c-323">The `storageAccountName` parameter must follow the [naming rules](../../best-practices/naming-conventions.md#naming-rules-and-restrictions) for Storage accounts.</span></span>
    - <span data-ttu-id="8971c-324">Para el parámetro `analysisServerAdmin`, use el nombre principal de usuario (UPN) de Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="8971c-324">For the `analysisServerAdmin` parameter, use your Azure Active Directory user principal name (UPN).</span></span>

4. <span data-ttu-id="8971c-325">Compruebe la implementación en Azure Portal revisando los recursos del grupo de recursos.</span><span class="sxs-lookup"><span data-stu-id="8971c-325">Verify the deployment in the Azure portal by reviewing the resources in the resource group.</span></span> <span data-ttu-id="8971c-326">Debería ver una cuenta de almacenamiento, la instancia de Azure SQL Data Warehouse y la instancia de Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="8971c-326">You should see a storage account, Azure SQL Data Warehouse instance, and Analysis Services instance.</span></span>

5. <span data-ttu-id="8971c-327">Use Azure Portal para obtener la clave de acceso para la cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="8971c-327">Use the Azure portal to get the access key for the storage account.</span></span> <span data-ttu-id="8971c-328">Seleccione la cuenta de almacenamiento para abrirla.</span><span class="sxs-lookup"><span data-stu-id="8971c-328">Select the storage account to open it.</span></span> <span data-ttu-id="8971c-329">En **Configuración**, seleccione **Claves de acceso**.</span><span class="sxs-lookup"><span data-stu-id="8971c-329">Under **Settings**, select **Access keys**.</span></span> <span data-ttu-id="8971c-330">Anote el valor de la clave principal.</span><span class="sxs-lookup"><span data-stu-id="8971c-330">Copy the primary key value.</span></span> <span data-ttu-id="8971c-331">Lo usará en el paso siguiente.</span><span class="sxs-lookup"><span data-stu-id="8971c-331">You will use it in the next step.</span></span>

### <a name="export-the-source-data-to-azure-blob-storage"></a><span data-ttu-id="8971c-332">Exportación de los datos de origen a Azure Blob Storage</span><span class="sxs-lookup"><span data-stu-id="8971c-332">Export the source data to Azure Blob storage</span></span> 

<span data-ttu-id="8971c-333">En este paso, ejecutará un script de PowerShell que usa bcp para exportar la base de datos SQL a archivos planos en la máquina virtual, y luego usa AzCopy para copiar estos archivos en Azure Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="8971c-333">In this step, you will run a PowerShell script that uses bcp to export the SQL database to flat files on the VM, and then uses AzCopy to copy those files into Azure Blob Storage.</span></span>

1. <span data-ttu-id="8971c-334">Use el Escritorio remoto para conectarse a la máquina virtual simulada local.</span><span class="sxs-lookup"><span data-stu-id="8971c-334">Use Remote Desktop to connect to the simulated on-premises VM.</span></span>

2. <span data-ttu-id="8971c-335">Mientas tiene iniciada sesión en la máquina virtual, ejecute los comandos siguientes en la ventana de PowerShell.</span><span class="sxs-lookup"><span data-stu-id="8971c-335">While logged into the VM, run the following commands from a PowerShell window.</span></span>  

    ```powershell
    cd 'C:\SampleDataFiles\reference-architectures\data\enterprise_bi_sqldw\onprem'

    .\Load_SourceData_To_Blob.ps1 -File .\sql_scripts\db_objects.txt -Destination 'https://<storage_account_name>.blob.core.windows.net/wwi' -StorageAccountKey '<storage_account_key>'
    ```

    <span data-ttu-id="8971c-336">Para el parámetro `Destination`, reemplace `<storage_account_name>` con el nombre de la cuenta de almacenamiento que creó anteriormente.</span><span class="sxs-lookup"><span data-stu-id="8971c-336">For the `Destination` parameter, replace `<storage_account_name>` with the name the Storage account that you created previously.</span></span> <span data-ttu-id="8971c-337">Para el parámetro `StorageAccountKey`, use la tecla de acceso para esa cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="8971c-337">For the `StorageAccountKey` parameter, use the access key for that Storage account.</span></span>

3. <span data-ttu-id="8971c-338">En Azure Portal, compruebe que los datos de origen se copiaron al almacenamiento de blobs yendo a la cuenta de almacenamiento, seleccionando el servicio Blob y abriendo el contenedor `wwi`.</span><span class="sxs-lookup"><span data-stu-id="8971c-338">In the Azure portal, verify that the source data was copied to Blob storage by navigating to the storage account, selecting the Blob service, and opening the `wwi` container.</span></span> <span data-ttu-id="8971c-339">Debería ver una lista de tablas que se prologa con `WorldWideImporters_Application_*`.</span><span class="sxs-lookup"><span data-stu-id="8971c-339">You should see a list of tables prefaced with `WorldWideImporters_Application_*`.</span></span>

### <a name="run-the-data-warehouse-scripts"></a><span data-ttu-id="8971c-340">Ejecución de los scripts de almacenamiento de datos</span><span class="sxs-lookup"><span data-stu-id="8971c-340">Run the data warehouse scripts</span></span>

1. <span data-ttu-id="8971c-341">En su sesión de escritorio remoto, inicie SQL Server Management Studio (SSMS).</span><span class="sxs-lookup"><span data-stu-id="8971c-341">From your Remote Desktop session, launch SQL Server Management Studio (SSMS).</span></span> 

2. <span data-ttu-id="8971c-342">Conexión a SQL Data Warehouse</span><span class="sxs-lookup"><span data-stu-id="8971c-342">Connect to SQL Data Warehouse</span></span>

    - <span data-ttu-id="8971c-343">Tipo de servidor: motor de base de datos</span><span class="sxs-lookup"><span data-stu-id="8971c-343">Server type: Database Engine</span></span>
    
    - <span data-ttu-id="8971c-344">Nombre del servidor: `<dwServerName>.database.windows.net`, donde `<dwServerName>` es el nombre que especificó al implementar los recursos de Azure.</span><span class="sxs-lookup"><span data-stu-id="8971c-344">Server name: `<dwServerName>.database.windows.net`, where `<dwServerName>` is the name that you specified when you deployed the Azure resources.</span></span> <span data-ttu-id="8971c-345">Encontrará este nombre en Azure Portal.</span><span class="sxs-lookup"><span data-stu-id="8971c-345">You can get this name from the Azure portal.</span></span>
    
    - <span data-ttu-id="8971c-346">Autenticación: autenticación de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8971c-346">Authentication: SQL Server Authentication.</span></span> <span data-ttu-id="8971c-347">Utilice las credenciales que especificó al implementar los recursos de Azure, en los parámetros `dwAdminLogin` y `dwAdminPassword`.</span><span class="sxs-lookup"><span data-stu-id="8971c-347">Use the credentials that you specified when you deployed the Azure resources, in the `dwAdminLogin` and `dwAdminPassword` parameters.</span></span>

2. <span data-ttu-id="8971c-348">Vaya a la carpeta `C:\SampleDataFiles\reference-architectures\data\enterprise_bi_sqldw\azure\sqldw_scripts` en la máquina virtual.</span><span class="sxs-lookup"><span data-stu-id="8971c-348">Navigate to the `C:\SampleDataFiles\reference-architectures\data\enterprise_bi_sqldw\azure\sqldw_scripts` folder on the VM.</span></span> <span data-ttu-id="8971c-349">Ejecutará los scripts de esta carpeta en orden numérico, de `STEP_1` hasta `STEP_7`.</span><span class="sxs-lookup"><span data-stu-id="8971c-349">You will execute the scripts in this folder in numerical order, `STEP_1` through `STEP_7`.</span></span>

3. <span data-ttu-id="8971c-350">Seleccione la base de datos `master` en SSMS y abra el script `STEP_1`.</span><span class="sxs-lookup"><span data-stu-id="8971c-350">Select the `master` database in SSMS and open the `STEP_1` script.</span></span> <span data-ttu-id="8971c-351">Cambie el valor de la contraseña en la siguiente línea y ejecute el script.</span><span class="sxs-lookup"><span data-stu-id="8971c-351">Change the value of the password in the following line, then execute the script.</span></span>

    ```sql
    CREATE LOGIN LoaderRC20 WITH PASSWORD = '<change this value>';
    ```

4. <span data-ttu-id="8971c-352">Seleccione la base de datos `wwi` en SSMS.</span><span class="sxs-lookup"><span data-stu-id="8971c-352">Select the `wwi` database in SSMS.</span></span> <span data-ttu-id="8971c-353">Abra el script `STEP_2` y ejecútelo.</span><span class="sxs-lookup"><span data-stu-id="8971c-353">Open the `STEP_2` script and execute the script.</span></span> <span data-ttu-id="8971c-354">Si recibe un error, asegúrese de que está ejecutando el script con la base de datos `wwi` y no `master`.</span><span class="sxs-lookup"><span data-stu-id="8971c-354">If you get an error, make sure you are running the script against the `wwi` database and not `master`.</span></span>

5. <span data-ttu-id="8971c-355">Abra una nueva conexión a SQL Data Warehouse, usando el usuario y la contraseña de `LoaderRC20` que se indican en el script `STEP_1`.</span><span class="sxs-lookup"><span data-stu-id="8971c-355">Open a new connection to SQL Data Warehouse, using the `LoaderRC20` user and the password indicated in the `STEP_1` script.</span></span>

6. <span data-ttu-id="8971c-356">Usando esta conexión abra el script `STEP_3`.</span><span class="sxs-lookup"><span data-stu-id="8971c-356">Using this connection, open the `STEP_3` script.</span></span> <span data-ttu-id="8971c-357">Establezca los valores siguientes en el script:</span><span class="sxs-lookup"><span data-stu-id="8971c-357">Set the following values in the script:</span></span>

    - <span data-ttu-id="8971c-358">SECRET: use la clave de acceso para la cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="8971c-358">SECRET: Use the access key for your storage account.</span></span>
    - <span data-ttu-id="8971c-359">LOCATION: use el nombre de la cuenta de almacenamiento como sigue: `wasbs://wwi@<storage_account_name>.blob.core.windows.net`.</span><span class="sxs-lookup"><span data-stu-id="8971c-359">LOCATION: Use the name of the storage account as follows: `wasbs://wwi@<storage_account_name>.blob.core.windows.net`.</span></span>

7. <span data-ttu-id="8971c-360">Con la misma conexión, ejecute los script del `STEP_4` hasta el `STEP_7` secuencialmente.</span><span class="sxs-lookup"><span data-stu-id="8971c-360">Using the same connection, execute scripts `STEP_4` through `STEP_7` sequentially.</span></span> <span data-ttu-id="8971c-361">Compruebe que cada script se completa correctamente antes de ejecutar el siguiente.</span><span class="sxs-lookup"><span data-stu-id="8971c-361">Verify that each script completes successfully before running the next.</span></span>

<span data-ttu-id="8971c-362">En SMSS, debería ver un conjunto de tablas `prd.*` en la base de datos `wwi`.</span><span class="sxs-lookup"><span data-stu-id="8971c-362">In SMSS, you should see a set of `prd.*` tables in the `wwi` database.</span></span> <span data-ttu-id="8971c-363">Para comprobar que se generaron los datos, ejecute la siguiente consulta:</span><span class="sxs-lookup"><span data-stu-id="8971c-363">To verify that the data was generated, run the following query:</span></span> 

```sql
SELECT TOP 10 * FROM prd.CityDimensions
```

## <a name="build-the-analysis-services-model"></a><span data-ttu-id="8971c-364">Creación del modelo de Analysis Services</span><span class="sxs-lookup"><span data-stu-id="8971c-364">Build the Analysis Services model</span></span>

<span data-ttu-id="8971c-365">En este paso, creará un modelo tabular que importa los datos del almacenamiento de datos.</span><span class="sxs-lookup"><span data-stu-id="8971c-365">In this step, you will create a tabular model that imports data from the data warehouse.</span></span> <span data-ttu-id="8971c-366">A continuación, implementará el modelo en Azure Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="8971c-366">Then you will deploy the model to Azure Analysis Services.</span></span>

1. <span data-ttu-id="8971c-367">En su sesión de escritorio remoto, inicie SQL Server Data Tools 2015.</span><span class="sxs-lookup"><span data-stu-id="8971c-367">From your Remote Desktop session, launch SQL Server Data Tools 2015.</span></span>

2. <span data-ttu-id="8971c-368">Seleccione **Archivo** > **Nuevo** > **Proyecto**.</span><span class="sxs-lookup"><span data-stu-id="8971c-368">Select **File** > **New** > **Project**.</span></span>

3. <span data-ttu-id="8971c-369">En el cuadro de diálogo **Nuevo proyecto** dentro de **Plantillas** seleccione **Business Intelligence** > **Analysis Services** > **Proyecto tabular de Analysis Services**.</span><span class="sxs-lookup"><span data-stu-id="8971c-369">In the **New Project** dialog, under **Templates**, select  **Business Intelligence** > **Analysis Services** > **Analysis Services Tabular Project**.</span></span> 

4. <span data-ttu-id="8971c-370">Asigne un nombre al proyecto y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="8971c-370">Name the project and click **OK**.</span></span>

5. <span data-ttu-id="8971c-371">En el cuadro de diálogo **Diseñador de modelos tabulares**, seleccione **Área de trabajo integrada** y establezca el **Nivel de compatibilidad** en `SQL Server 2017 / Azure Analysis Services (1400)`.</span><span class="sxs-lookup"><span data-stu-id="8971c-371">In the **Tabular model designer** dialog, select **Integrated workspace**  and set **Compatibility level** to `SQL Server 2017 / Azure Analysis Services (1400)`.</span></span> <span data-ttu-id="8971c-372">Haga clic en **OK**.</span><span class="sxs-lookup"><span data-stu-id="8971c-372">Click **OK**.</span></span>

6. <span data-ttu-id="8971c-373">En la ventana del **Explorador de modelos tabulares**, haga clic con el botón derecho en el proyecto y seleccione **Importar desde el origen de datos**.</span><span class="sxs-lookup"><span data-stu-id="8971c-373">In the **Tabular Model Explorer** window, right-click the project and select **Import from Data Source**.</span></span>

7. <span data-ttu-id="8971c-374">Seleccione **Azure SQL Data Warehouse** y haga clic en **Conectar**.</span><span class="sxs-lookup"><span data-stu-id="8971c-374">Select **Azure SQL Data Warehouse** and click **Connect**.</span></span>

8. <span data-ttu-id="8971c-375">Para **Servidor**, escriba el nombre completo del servidor de Azure SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="8971c-375">For **Server**, enter the fully qualified name of your Azure SQL Data Warehouse server.</span></span> <span data-ttu-id="8971c-376">Para **Base de datos**, escriba `wwi`.</span><span class="sxs-lookup"><span data-stu-id="8971c-376">For **Database**, enter `wwi`.</span></span> <span data-ttu-id="8971c-377">Haga clic en **OK**.</span><span class="sxs-lookup"><span data-stu-id="8971c-377">Click **OK**.</span></span>

9. <span data-ttu-id="8971c-378">En el siguiente cuadro de diálogo, elija autenticación de **Base de datos** y escriba el nombre de usuario y la contraseña de Azure SQL Data Warehouse y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="8971c-378">In the next dialog, choose **Database** authentication and enter your Azure SQL Data Warehouse user name and password, and click **OK**.</span></span>

10. <span data-ttu-id="8971c-379">En el cuadro de diálogo **Navegador**, seleccione las casillas de verificación para **prd.CityDimensions**, **prd.DateDimensions**, y **prd.SalesFact**.</span><span class="sxs-lookup"><span data-stu-id="8971c-379">In the **Navigator** dialog, select the checkboxes for **prd.CityDimensions**, **prd.DateDimensions**, and **prd.SalesFact**.</span></span> 

    ![](./images/analysis-services-import.png)

11. <span data-ttu-id="8971c-380">Haga clic en **Cargar**.</span><span class="sxs-lookup"><span data-stu-id="8971c-380">Click **Load**.</span></span> <span data-ttu-id="8971c-381">Una vez completado el procesamiento, haga clic en **Cerrar**.</span><span class="sxs-lookup"><span data-stu-id="8971c-381">When processing is complete, click **Close**.</span></span> <span data-ttu-id="8971c-382">Debería ver una vista tabular de los datos.</span><span class="sxs-lookup"><span data-stu-id="8971c-382">You should now see a tabular view of the data.</span></span>

12. <span data-ttu-id="8971c-383">En la ventana del **Explorador de modelos tabulares**, haga clic con el botón derecho en el proyecto y seleccione **Vista de modelo** > **Vista de diagrama**.</span><span class="sxs-lookup"><span data-stu-id="8971c-383">In the **Tabular Model Explorer** window, right-click the project and select **Model View** > **Diagram View**.</span></span>

13. <span data-ttu-id="8971c-384">Arrastre el campo **[prd.SalesFact].[WWI City ID]** hasta el campo **[prd.CityDimensions].[WWI City ID]** para crear una relación.</span><span class="sxs-lookup"><span data-stu-id="8971c-384">Drag the **[prd.SalesFact].[WWI City ID]** field to the **[prd.CityDimensions].[WWI City ID]** field to create a relationship.</span></span>  

14. <span data-ttu-id="8971c-385">Arrastre el campo **[prd.SalesFact].[Invoice Date Key]** hasta el campo **[prd.DateDimensions].[Date]**.</span><span class="sxs-lookup"><span data-stu-id="8971c-385">Drag the **[prd.SalesFact].[Invoice Date Key]** field to the **[prd.DateDimensions].[Date]** field.</span></span>  
    ![](./images/analysis-services-relations.png)

15. <span data-ttu-id="8971c-386">En el menú **Archivo**, haga clic en **Guardar todo**.</span><span class="sxs-lookup"><span data-stu-id="8971c-386">From the **File** menu, choose **Save All**.</span></span>  

16. <span data-ttu-id="8971c-387">En el **Explorador de soluciones**, haga clic con el botón derecho en el proyecto y seleccione **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="8971c-387">In **Solution Explorer**, right-click the project and select **Properties**.</span></span> 

17. <span data-ttu-id="8971c-388">En **Servidor**, escriba la dirección URL de la instancia de Azure Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="8971c-388">Under **Server**, enter the URL of your Azure Analysis Services instance.</span></span> <span data-ttu-id="8971c-389">Puede encontrar este valor en Azure Portal.</span><span class="sxs-lookup"><span data-stu-id="8971c-389">You can get this value from the Azure Portal.</span></span> <span data-ttu-id="8971c-390">En el portal, seleccione el recurso Analysis Services, haga clic en el panel de información general y busque la propiedad **Nombre del servidor**.</span><span class="sxs-lookup"><span data-stu-id="8971c-390">In the portal, select the Analysis Services resource, click the Overview pane, and look for the **Server Name** property.</span></span> <span data-ttu-id="8971c-391">Será algo similar a `asazure://westus.asazure.windows.net/contoso`.</span><span class="sxs-lookup"><span data-stu-id="8971c-391">It will be similar to `asazure://westus.asazure.windows.net/contoso`.</span></span> <span data-ttu-id="8971c-392">Haga clic en **OK**.</span><span class="sxs-lookup"><span data-stu-id="8971c-392">Click **OK**.</span></span>

    ![](./images/analysis-services-properties.png)

18. <span data-ttu-id="8971c-393">En el **Explorador de soluciones**, haga clic con el botón derecho en el proyecto y seleccione **Implementar**.</span><span class="sxs-lookup"><span data-stu-id="8971c-393">In **Solution Explorer**, right-click the project and select **Deploy**.</span></span> <span data-ttu-id="8971c-394">Inicie sesión en Azure si se le solicita.</span><span class="sxs-lookup"><span data-stu-id="8971c-394">Sign into Azure if prompted.</span></span> <span data-ttu-id="8971c-395">Una vez completado el procesamiento, haga clic en **Cerrar**.</span><span class="sxs-lookup"><span data-stu-id="8971c-395">When processing is complete, click **Close**.</span></span>

19. <span data-ttu-id="8971c-396">En Azure Portal, vea los detalles de la instancia de Azure Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="8971c-396">In the Azure portal, view the details for your Azure Analysis Services instance.</span></span> <span data-ttu-id="8971c-397">Compruebe que el modelo aparece en la lista de modelos.</span><span class="sxs-lookup"><span data-stu-id="8971c-397">Verify that your model appears in the list of models.</span></span>

    ![](./images/analysis-services-models.png)

## <a name="analyze-the-data-in-power-bi-desktop"></a><span data-ttu-id="8971c-398">Análisis de los datos de Power BI Desktop</span><span class="sxs-lookup"><span data-stu-id="8971c-398">Analyze the data in Power BI Desktop</span></span>

<span data-ttu-id="8971c-399">En este paso, usará Power BI para crear un informe de los datos en Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="8971c-399">In this step, you will use Power BI to create a report from the data in Analysis Services.</span></span>

1. <span data-ttu-id="8971c-400">En su sesión de escritorio remoto, inicie Power BI Desktop.</span><span class="sxs-lookup"><span data-stu-id="8971c-400">From your Remote Desktop session, launch Power BI Desktop.</span></span>

2. <span data-ttu-id="8971c-401">En la pantalla de bienvenida, haga clic en **Get Data** (Obtener datos).</span><span class="sxs-lookup"><span data-stu-id="8971c-401">In the Welcome Scren, click **Get Data**.</span></span>

3. <span data-ttu-id="8971c-402">Seleccione **Azure** > **Base de datos de Azure Analysis Services**.</span><span class="sxs-lookup"><span data-stu-id="8971c-402">Select **Azure** > **Azure Analysis Services database**.</span></span> <span data-ttu-id="8971c-403">Haga clic en **Conectar**</span><span class="sxs-lookup"><span data-stu-id="8971c-403">Click **Connect**</span></span>

    ![](./images/power-bi-get-data.png)

4. <span data-ttu-id="8971c-404">Escriba la dirección URL de la instancia de Analysis Services y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="8971c-404">Enter the URL of your Analysis Services instance, then click **OK**.</span></span> <span data-ttu-id="8971c-405">Inicie sesión en Azure si se le solicita.</span><span class="sxs-lookup"><span data-stu-id="8971c-405">Sign into Azure if prompted.</span></span>

5. <span data-ttu-id="8971c-406">En el cuadro de diálogo **Navegador**, expanda el proyecto tabular que ha implementado, seleccione el modelo que ha creado y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="8971c-406">In the **Navigator** dialog, expand the tabular project that you deployed, select the model that you created, and click **OK**.</span></span>

2. <span data-ttu-id="8971c-407">En el panel **Visualizaciones**, seleccione el icono **Gráfico de barras apiladas**.</span><span class="sxs-lookup"><span data-stu-id="8971c-407">In the **Visualizations** pane, select the **Stacked Bar Chart** icon.</span></span> <span data-ttu-id="8971c-408">En la vista de informe, cambie el tamaño de la visualización para que sea mayor.</span><span class="sxs-lookup"><span data-stu-id="8971c-408">In the Report view, resize the visualization to make it larger.</span></span>

6. <span data-ttu-id="8971c-409">En el panel **Campos**, expanda **prd.CityDimensions**.</span><span class="sxs-lookup"><span data-stu-id="8971c-409">In the **Fields** pane, expand **prd.CityDimensions**.</span></span>

7. <span data-ttu-id="8971c-410">Arrastre **prd.CityDimensions** > **WWI City ID** al espacio **Eje**.</span><span class="sxs-lookup"><span data-stu-id="8971c-410">Drag **prd.CityDimensions** > **WWI City ID** to the **Axis** well.</span></span>

8. <span data-ttu-id="8971c-411">Arrastre **prd.CityDimensions** > **City** al espacio **Leyenda**.</span><span class="sxs-lookup"><span data-stu-id="8971c-411">Drag **prd.CityDimensions** > **City** to the **Legend** well.</span></span>

9. <span data-ttu-id="8971c-412">En el panel **Campos** expanda **prd.SalesFact**.</span><span class="sxs-lookup"><span data-stu-id="8971c-412">In the **Fields** pane, expand **prd.SalesFact**.</span></span>

10. <span data-ttu-id="8971c-413">Arrastre **prd.SalesFact** > **Total Excluding Tax** al espacio **Valor**.</span><span class="sxs-lookup"><span data-stu-id="8971c-413">Drag **prd.SalesFact** > **Total Excluding Tax** to the **Value** well.</span></span>

    ![](./images/power-bi-visualization.png)

11. <span data-ttu-id="8971c-414">En **Filtros de nivel de objeto visual**, seleccione **WWI City ID**.</span><span class="sxs-lookup"><span data-stu-id="8971c-414">Under **Visual Level Filters**, select **WWI City ID**.</span></span>

12. <span data-ttu-id="8971c-415">Establezca el **Tipo de filtro** en `Top N` y **Mostrar artículos** en `Top 10`.</span><span class="sxs-lookup"><span data-stu-id="8971c-415">Set the **Filter Type** to `Top N`, and set **Show Items** to `Top 10`.</span></span>

13. <span data-ttu-id="8971c-416">Arrastre **prd.SalesFact** > **Total Excluding Tax** al espacio **Por valor**</span><span class="sxs-lookup"><span data-stu-id="8971c-416">Drag **prd.SalesFact** > **Total Excluding Tax** to the **By Value** well</span></span>

    ![](./images/power-bi-visualization2.png)

14. <span data-ttu-id="8971c-417">Haga clic en **Aplicar filtro**.</span><span class="sxs-lookup"><span data-stu-id="8971c-417">Click **Apply Filter**.</span></span> <span data-ttu-id="8971c-418">La visualización muestra las 10 ventas totales principales por ciudad.</span><span class="sxs-lookup"><span data-stu-id="8971c-418">The visualization shows the top 10 total sales by city.</span></span>

    ![](./images/power-bi-report.png)

<span data-ttu-id="8971c-419">Para aprender más acerca de Power BI Desktop consulte [Introducción a Power BI Desktop](/power-bi/desktop-getting-started).</span><span class="sxs-lookup"><span data-stu-id="8971c-419">To learn more about Power BI Desktop, see [Getting started with Power BI Desktop](/power-bi/desktop-getting-started).</span></span>

## <a name="next-steps"></a><span data-ttu-id="8971c-420">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="8971c-420">Next steps</span></span>

- <span data-ttu-id="8971c-421">Para más información acerca de esta arquitectura de referencia visite el [repositorio de GitHub][ref-arch-repo-folder].</span><span class="sxs-lookup"><span data-stu-id="8971c-421">For more information about this reference architecture, visit our [GitHub repository][ref-arch-repo-folder].</span></span>
- <span data-ttu-id="8971c-422">Más información acerca de [Azure Building Blocks][azbb-repo].</span><span class="sxs-lookup"><span data-stu-id="8971c-422">Learn about the [Azure Building Blocks][azbb-repo].</span></span>

<!-- links -->

[azure-cli-2]: /azure/install-azure-cli
[azbb-repo]: https://github.com/mspnp/template-building-blocks
[azbb-wiki]: https://github.com/mspnp/template-building-blocks/wiki/Install-Azure-Building-Blocks
[github-folder]: https://github.com/mspnp/reference-architectures/tree/master/data/enterprise_bi_sqldw
[ref-arch-repo]: https://github.com/mspnp/reference-architectures
[ref-arch-repo-folder]: https://github.com/mspnp/reference-architectures/tree/master/data/enterprise_bi_sqldw
[wwi]: /sql/sample/world-wide-importers/wide-world-importers-oltp-database
